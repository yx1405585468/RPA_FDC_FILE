{"nodeType":[{"description":"kafka输入","functionDesc":"功能描述:\r\n- kafka 根据配置创建链接，每次读取指定时间范围内(固定5s、最大读取量10w) 数据之后，根据column_types进行类型转换，得到对应的数据，\r\n最终变换成DataFrame, 可以供给后置的算法进行使用， 读取方式参考 kafka_poll_type 参数\r\n\r\n输入端口:\r\n- 无\r\n\r\n输出端口:\r\n- 1个数据集\r\n\r\n参数:\r\n- kafka地址\r\n- kafka订阅的主题\r\n- 读取位置方式：1=最早偏移（earliest-offsets） 2=最晚偏移（latest-offsets） 3=指定分区偏移（specific-offsets） 4=时间戳（timstamp）\r\n- 分区id：当 read_type = 3 or 4 指定分区类型\r\n- 分区偏移量： 当 read_type = 3 指定分区类型\r\n- 时间字符串：当 read_type = 4 时间戳\r\n- 拉取方式：1：拉取一次返回，拉取不到，返回无法获取数据异常，2：循环拉取，直至拉取到数据返回\r\n- 连接kafka超时时间：单位毫秒\r\n- 列需要转换的类型：json数组字符串, 列需要转换的类型\r\n  如果是时间类型，pattern 不为空， 范例如下：\r\n  [{\r\n  \"columnName\": \"paramType\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }, {\r\n  \"columnName\": \"paramName\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }, {\r\n  \"columnName\": \"paramIndex\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"int\"\r\n  }, {\r\n  \"columnName\": \"paramValue\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }\r\n  ]","id":"25","typeName":"kafka_input"},{"description":"kafka输出","functionDesc":"功能描述:\r\n- 一般作为作为流程最后一个组件，当建模流程或者发布流程计算完毕之后， 推送到kafka，然后整个流程完结\r\n\r\n输入端口:\r\n- 1个数据集\r\n\r\n输出端口:\r\n- 无\r\n\r\n参数:\r\n- kafka地址\r\n- kafka订阅的主题\r\n- 列需要转换的类型：json数组字符串, 列需要转换的类型\r\n  如果是时间类型，pattern 不为空， 范例如下：\r\n  [{\r\n  \"columnName\": \"paramType\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }, {\r\n  \"columnName\": \"paramName\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }, {\r\n  \"columnName\": \"paramIndex\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"int\"\r\n  }, {\r\n  \"columnName\": \"paramValue\",\r\n  \"pattern\": \"\",\r\n  \"type\": \"string\"\r\n  }\r\n  ]","id":"26","typeName":"kafka_out"},{"description":"python扩展编程","functionDesc":"功能描述:\r\n- 该组件支持写入python 代码， 实现自定义的数据处理功能，或者创建模型， 模型预测， 评估等自由度较高的自定义功能\r\n\r\n输入端口:\r\n- 多个数据集\r\n- 多个模型\r\n\r\n输出端口:\r\n- 多个数据集\r\n- 多个模型\r\n\r\n参数:\r\n - 输入节点新增参数(选择数据或模型)\r\n - 输出节点新增参数(选择数据或模型)\r\n - 新增代码参数\r\n\r\n备注\r\n - 输入参数：模型 + 数据集数量最多5个\r\n - 输出参数：模型 + 数据集数量最多5个","id":"27","typeName":"python_extension_program"}],"params":[],"content":"{\"nodes\":[{\"position\":{\"x\":-150,\"y\":-60},\"shape\":\"custom\",\"id\":\"7fe5aa03-3875-43bd-b7f6-21adda4b3362\",\"icon\":\"python_extension_program\",\"zIndex\":2,\"data\":{\"nodeTypeCh\":\"python编程\",\"nodeTypeId\":27,\"nodeTypeName\":\"python_extension_program\",\"name\":\"数据处理与建模\",\"description\":\"\",\"config\":[{\"paramName\":\"output_params\",\"paramIndex\":1,\"paramValue\":\"df1\",\"paramType\":\"string\"},{\"paramName\":\"script_str\",\"paramIndex\":2,\"paramValue\":\"aW1wb3J0IHBhbmRhcyBhcyBwZA0KaW1wb3J0IHB5c3BhcmsucGFuZGFzIGFzIHBzDQppbXBvcnQgcmVxdWVzdHMNCmltcG9ydCBqc29uDQoNCmZyb20gc3FsYWxjaGVteSBpbXBvcnQgY3JlYXRlX2VuZ2luZQ0KZnJvbSBwY2EgaW1wb3J0IHBjYQ0KZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IHBhbmRhc191ZGYsIFBhbmRhc1VERlR5cGUsIG1heCwgY29sLCBjb3VudERpc3RpbmN0LCB3aGVuLCByYW5rLCBsaXQNCmZyb20gcHlzcGFyay5zcWwudHlwZXMgaW1wb3J0IFN0cnVjdFR5cGUsIFN0cnVjdEZpZWxkLCBJbnRlZ2VyVHlwZSwgU3RyaW5nVHlwZSwgRmxvYXRUeXBlDQpmcm9tIHB5c3Bhcmsuc3FsLndpbmRvdyBpbXBvcnQgV2luZG93DQoNCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IHRyYWluX3Rlc3Rfc3BsaXQsIEdyaWRTZWFyY2hDVg0KZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IFN0YW5kYXJkU2NhbGVyDQpmcm9tIHNrbGVhcm4uZW5zZW1ibGUgaW1wb3J0IFJhbmRvbUZvcmVzdENsYXNzaWZpZXINCmZyb20gc2tsZWFybi5pbXB1dGUgaW1wb3J0IFNpbXBsZUltcHV0ZXINCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCByb2NfYXVjX3Njb3JlDQpmcm9tIHNrbGVhcm4ucGlwZWxpbmUgaW1wb3J0IFBpcGVsaW5lDQpmcm9tIGltYmxlYXJuLnVuZGVyX3NhbXBsaW5nIGltcG9ydCBDbHVzdGVyQ2VudHJvaWRzDQoNCmZyb20gYmFja2VuZF9zcGFyay5kb3Jpc19jb21tb24uZG9yaXNfY2xpZW50IGltcG9ydCBEb3Jpc0NsaWVudA0KZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHJlZHVjZQ0KZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgRGF0YUZyYW1lDQpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyPop6PmnpBTUUwjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIGRvcmlzIOaVsOaNruW6k+i/nuaOpQ0KY2xpZW50ID0gRG9yaXNDbGllbnQoIjEwLjUyLjE5OS44MSIsIDE4MDMwLCA5MDMwLCB1c2VyPSJyb290IiwgcGFzc3dvcmQ9Ik5leGNoaXBAMTIzIiwgZGF0YV9iYXNlPSJldGwiLA0KICAgICAgICAgICAgICAgICAgICAgbWVtX2xpbWl0PSI2ODcxOTQ3NjczNiIpDQogICAgICAgICAgICAgICAgICAgICANCiIiIuino+aekHNxbCDnmoTovoXliqnlh73mlbAiIiINCmRlZiByZWFkX3NxbChzcWxfc3RhdCwgcmVhZF9jbGllbnQ9Y2xpZW50LCBzZXNzaW9uPXNwYXJrKToNCiAgICBkZjEgPSByZWFkX2NsaWVudC5kb3Jpc19yZWFkKHNlc3Npb24sIHNxbF9zdGF0KQ0KICAgIHJldHVybiBkZjENCg0KDQpkZWYgcHJvY2Vzc19saWtlKGtleTogc3RyLCB2YWx1ZTogbGlzdFtzdHJdKSAtPiBzdHI6DQogICAgIyDlpITnkIbmqKHns4rmnaHku7bnmoTljLnphY06IChrZXkgbGlrZSAnYWElJyBvciBrZXkgbGlrZSAiYmIlIikNCiAgICBrZXkgPSBrZXl3b3JkX21hcF9mcm9tX2pzb25fdG9fdGFibGUuZ2V0KGtleSkNCiAgICB2X2pvaW4gPSAnIG9yICcuam9pbihbZiJkMS57a2V5fSBsaWtlICAne3YucmVwbGFjZSgnKicsICclJyl9JyAiIGZvciB2IGluIHZhbHVlXSkNCiAgICByZXR1cm4gIih7fSkiLmZvcm1hdCh2X2pvaW4pDQoNCg0KZGVmIHByb2Nlc3Nfbm90X2xpa2Uoa2V5OiBzdHIsIHZhbHVlOiBsaXN0W3N0cl0pIC0+IHN0cjoNCiAgICAjIOWkhOeQhumdnuaooeeziuadoeS7tueahOWMuemFjTprZXkgaW4gKCdhYScsICdiYicpDQogICAga2V5ID0ga2V5d29yZF9tYXBfZnJvbV9qc29uX3RvX3RhYmxlLmdldChrZXkpDQogICAgdl9qb2luID0gIiwiLmpvaW4oW2YiJ3t2fSciIGZvciB2IGluIHZhbHVlXSkNCiAgICByZXR1cm4gImQxLnt9IGluICh7fSkiLmZvcm1hdChrZXksIHZfam9pbikNCg0KDQpkZWYgdGVzdF9ub3RfbGlrZSgpOg0KICAgIHJlc3VsdCA9IChwcm9jZXNzX25vdF9saWtlKCJ0b29sX25hbWUiLCBbImFhIiwgImJiIiwgImNjIl0pKQ0KICAgIGFzc2VydCAidG9vbF9uYW1lIGluICgnYWEnLCdiYicsJ2NjJykiID09IHJlc3VsdCwgIm5vdCBsaWtlIOmqjOivgeWksei0pSINCg0KDQpkZWYgdGVzdF9saWtlKCk6DQogICAgcmVzdWx0ID0gcHJvY2Vzc19saWtlKCJ0b29sX25hbWUiLCBbImFhKiIsICJiYioiLCAiY2MqIl0pDQogICAgYXNzZXJ0ICIodG9vbF9uYW1lIGxpa2UgICdhYSUnICBvciB0b29sX25hbWUgbGlrZSAgJ2JiJScgIG9yIHRvb2xfbmFtZSBsaWtlICAnY2MlJyApIiA9PSByZXN1bHQsICJsaWtlIOmqjOivgeWksei0pSINCg0KDQpkZWYgcHJvY2Vzc19vbmVfa2V5d29yZChrZXksIHZhbHVlOiBsaXN0W3N0cl0pIC0+IE9wdGlvbmFsW3N0cl06DQogICAgaWYgbGVuKHZhbHVlKSA9PSAwOg0KICAgICAgICByZXR1cm4gTm9uZQ0KDQogICAgbm90X2xpa2VfbGlzdCA9IFt2IGZvciB2IGluIHZhbHVlIGlmICIqIiBub3QgaW4gdl0NCiAgICBsaWtlX2xpc3QgPSBbdiBmb3IgdiBpbiB2YWx1ZSBpZiAiKiIgaW4gdl0NCg0KICAgICMg5aSE55CG5qih57OK5p2h5Lu2DQogICAgaWYgbGVuKG5vdF9saWtlX2xpc3QpICE9IDA6DQogICAgICAgIG5vdF9saWtlX3NxbF9zdHIgPSBwcm9jZXNzX25vdF9saWtlKGtleSwgbm90X2xpa2VfbGlzdCkNCiAgICBlbHNlOg0KICAgICAgICBub3RfbGlrZV9zcWxfc3RyID0gIiINCg0KICAgICMg5aSE55CG6Z2e5qih57OK5p2h5Lu2DQoNCiAgICBpZiBsZW4obGlrZV9saXN0KSAhPSAwOg0KICAgICAgICBsaWtlX3NxbF9zdHIgPSBwcm9jZXNzX2xpa2Uoa2V5LCBsaWtlX2xpc3QpDQogICAgZWxzZToNCiAgICAgICAgbGlrZV9zcWxfc3RyID0gIiINCg0KICAgICMg5Y676Zmk5Li65LiA5Liq5YWD57Sg5Li656m65a2X56ym5Liy55qE5oOF5Ya155qE5oOF5Ya155qE5oOF5Ya1DQogICAgY29uY2F0X3NxbF9zdHJfbGlzdCA9IFtzcWxfc3RyIGZvciBzcWxfc3RyIGluIFtsaWtlX3NxbF9zdHIsIG5vdF9saWtlX3NxbF9zdHJdIGlmIGxlbihzcWxfc3RyKSAhPSAwXQ0KICAgICMg5L2/55Sob3Ig5pON5L2cIOWNleWtl+autei/h+a7pCDnmoRsaWtlIOWSjCBub3QgbGlrZSDor63lj6UNCiAgICByZXR1cm4gIigiICsgIiBvciAiLmpvaW4oY29uY2F0X3NxbF9zdHJfbGlzdCkgKyAiKSINCg0KDQpkZWYgY2hlY2tfdGltZV9zdGFydF9lbmQobWluX3RpbWUsIG1heF90aW1lKToNCiAgICBpZiBtaW5fdGltZSBpcyBub3QgTm9uZSBhbmQgbWF4X3RpbWUgaXMgbm90IE5vbmU6DQogICAgICAgIHBhc3MNCiAgICBlbHNlOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCLotbflp4vml7bpl7Tlkoznu5PmnZ/ml7bpl7Tlv4XpobvlhajloasiKQ0KDQpkZWYgZ2V0X3RpbWVfc2VsZWN0aW9uX3NxbCh0aW1lX2tleXdvcmQsIG1heF90aW1lPU5vbmUsIG1pbl90aW1lPU5vbmUpOg0KICAgICIiIg0KICAgIOiOt+WPluaXtumXtOWMuumXtOeahOetm+mAieeahHNxbCwg6LW35aeL5pe26Ze05ZKM57uT5p2f5pe26Ze06YO95piv5Y+v6YCJ55qEDQogICAgOnBhcmFtIHRpbWVfa2V5d29yZDoNCiAgICA6cGFyYW0gbWF4X3RpbWU6DQogICAgOnBhcmFtIG1pbl90aW1lOg0KICAgIDpyZXR1cm46DQogICAgIiIiDQogICAgIyDmoLnmja7lj5blgLzvvIznlJ/miJDljZXkuKrml7bpl7Tov4fmu6TmnaHku7YNCiAgICBpZiBtaW5fdGltZToNCiAgICAgICAgdGltZV9wYXJ0X21pbiA9IGYiZDEue3RpbWVfa2V5d29yZH0gPj0gJ3ttaW5fdGltZX0nIg0KICAgIGVsc2U6DQogICAgICAgIHRpbWVfcGFydF9taW4gPSAiICINCg0KICAgIGlmIG1heF90aW1lOg0KICAgICAgICB0aW1lX3BhcnRfbWF4ID0gZiJkMS57dGltZV9rZXl3b3JkfSA8ICd7bWF4X3RpbWV9JyINCiAgICBlbHNlOg0KICAgICAgICB0aW1lX3BhcnRfbWF4ID0gIiAiDQoNCiAgICAjIOWmguaenOWtmOWcqO+8jOaLvOaOpeWkmuS4quafpeivouadoeS7tu+8jOaIluiAheWPquS/neeVmeS4gOS4qui/h+a7pOadoeS7tg0KICAgIGlmIChtYXhfdGltZSBpcyBub3QgTm9uZSkgYW5kIChtaW5fdGltZSBpcyBub3QgTm9uZSk6DQogICAgICAgIHRpbWVfc3FsID0gZicge3RpbWVfcGFydF9taW59IGFuZCB7dGltZV9wYXJ0X21heH0nDQogICAgZWxpZiAobWF4X3RpbWUgaXMgTm9uZSkgYW5kIChtaW5fdGltZSBpcyBOb25lKToNCiAgICAgICAgdGltZV9zcWwgPSAiICINCiAgICBlbHNlOg0KICAgICAgICB0aW1lX3NxbCA9IHRpbWVfcGFydF9tYXggaWYgbWF4X3RpbWUgZWxzZSB0aW1lX3BhcnRfbWluDQoNCiAgICByZXR1cm4gdGltZV9zcWwNCg0KZGVmIGNvbmNhdF90aW1lX2ZpbHRlcl9zcWxfd2l0aF9vdGhlcl9rZXl3b3JkX3NxbCh0aW1lX2ZpbHRlcl9zcWw6IHN0ciwgb3RoZXJfa2V5d29yZF9zcWw6c3RyKSAtPiBzdHI6DQogICAgIiIiDQogICAg5ou85o6l5pe26Ze06L+H5ruk5p2h5Lu25LiO6Z2e5pe26Ze06L+H5ruk5p2h5Lu2DQogICAgOnBhcmFtIHRpbWVfZmlsdGVyX3NxbDoNCiAgICA6cGFyYW0gb3RoZXJfa2V5d29yZF9zcWw6DQogICAgOnJldHVybjoNCiAgICAiIiINCiAgICB0aW1lX3N0cmlwID0gdGltZV9maWx0ZXJfc3FsLnN0cmlwKCkNCiAgICBvdGhlcl9zdHJpcCA9IG90aGVyX2tleXdvcmRfc3FsLnN0cmlwKCkNCiAgICBpZiBsZW4odGltZV9zdHJpcCkgPT0gMCBhbmQgbGVuKG90aGVyX3N0cmlwKSA9PSAwOg0KICAgICAgICByZXR1cm4gIiINCiAgICBlbGlmIGxlbih0aW1lX3N0cmlwKSAhPSAwIGFuZCBsZW4ob3RoZXJfc3RyaXApID09IDA6DQogICAgICAgIHJldHVybiAgdGltZV9maWx0ZXJfc3FsDQogICAgZWxpZiBsZW4odGltZV9zdHJpcCkgPT0gMCBhbmQgbGVuKG90aGVyX3N0cmlwKSAhPSAwOg0KICAgICAgICByZXR1cm4gb3RoZXJfa2V5d29yZF9zcWwNCiAgICBlbHNlOg0KICAgICAgICByZXR1cm4gZid7dGltZV9maWx0ZXJfc3FsfSBhbmQge290aGVyX2tleXdvcmRfc3FsfScNCiAgICANCiAgICANCmRlZiB0cmFuc19zZWxlY3RfY29uZGl0aW9uX3RvX3NxbF93aXRoX2xhYmVsKHNlbGVjdF9jb25kaXRpb25fZGljdDogZGljdCwgdGFibGVfbmFtZTogc3RyKSAtPiBzdHI6DQogICAgIyDmn6Xor6LmnaHku7bovaxzcWws5bm25omT5qCH562+77yMbGFiZWwgJzAnOiBnb29kIHdhZmVyLCAnMSc6IGJhZCB3YWZlcg0KICAgIGZpbHRlcl9zcWxfbGlzdCA9IFtdDQogICAgZm9yIGtleXdvcmQsIHZhbHVlIGluIHNlbGVjdF9jb25kaXRpb25fZGljdC5pdGVtcygpOg0KICAgICAgICBpZiBrZXl3b3JkIG5vdCBpbiBbImRhdGVSYW5nZSIsICJ3YWZlcklkIiwgInVwbG9hZElkIiwgIm1lcmdlUHJvZGcxIiwgIm1lcmdlT3Blcm5vIl06DQogICAgICAgICAgICBzcWxfZmlsdGVyX29uZV9rZXl3b3JkID0gcHJvY2Vzc19vbmVfa2V5d29yZChrZXl3b3JkLCB2YWx1ZSkNCiAgICAgICAgICAgIGlmIHNxbF9maWx0ZXJfb25lX2tleXdvcmQgaXMgbm90IE5vbmU6DQogICAgICAgICAgICAgICAgZmlsdGVyX3NxbF9saXN0LmFwcGVuZChzcWxfZmlsdGVyX29uZV9rZXl3b3JkKQ0KDQogICAgIyDlpITnkIbml7bpl7TljLrpl7QNCiAgICB0aW1lX2JpbiA9IHNlbGVjdF9jb25kaXRpb25fZGljdC5nZXQoImRhdGVSYW5nZSIpDQoNCg0KICAgIGlmIGxlbih0aW1lX2JpbikgPT0gMTogIyBsaXN0W2RpY3RdDQogICAgICAgIHRpbWVfYmluX2RpY3QgPSB0aW1lX2JpblswXQ0KICAgICAgICBtaW5fdGltZSA9IHRpbWVfYmluX2RpY3QuZ2V0KCJzdGFydCIpDQogICAgICAgIG1heF90aW1lID0gdGltZV9iaW5fZGljdC5nZXQoImVuZCIpDQogICAgZWxzZToNCiAgICAgICAgbWluX3RpbWUgPSBOb25lDQogICAgICAgIG1heF90aW1lID0gTm9uZSANCg0KICAgICMg5Y676Zmk5pe26Ze05qOA5p+l77yM5pe26Ze06IyD5Zu05Li65Y+v6YCJ6L6T5YWlDQogICAgIyDmo4Dmn6Xotbflp4vml7bpl7Tlkoznu5PmnZ/ml7bpl7Tlhajpg6jpnZ7nqboNCiAgICAjIGNoZWNrX3RpbWVfc3RhcnRfZW5kKG1pbl90aW1lLCBtYXhfdGltZSkNCg0KICAgICMg5aSE55CGd2FmZXJJZA0KICAgIHdhZmVySWQgPSBzZWxlY3RfY29uZGl0aW9uX2RpY3QuZ2V0KCJ3YWZlcklkIikNCiAgICBnb29kX3dhZmVyX2xpc3QgPSB3YWZlcklkLmdldCgiZ29vZCIpDQogICAgYmFkX3dhZmVyX2xpc3QgPSB3YWZlcklkLmdldCgiYmFkIikNCiAgICB1cGxvYWRfaWQgPSBzZWxlY3RfY29uZGl0aW9uX2RpY3QuZ2V0KCJ1cGxvYWRJZCIpDQogICAgIyB1cGxvYWRfaWQgPSAnMjAyMzExMTYxNTI4MDg3NzEnDQoNCiAgICAjIOagueaNrnRpbWUg6L+H5ruk5p2h5Lu2LOeUn+aIkHNxbA0KICAgIHRpbWVfZmlsdGVyX3NxbCA9IGdldF90aW1lX3NlbGVjdGlvbl9zcWwodGltZV9rZXl3b3JkPWtleXdvcmRfbWFwX2Zyb21fanNvbl90b190YWJsZS5nZXQoJ2RhdGVSYW5nZScpLCBtYXhfdGltZT1tYXhfdGltZSwgbWluX3RpbWU9bWluX3RpbWUpDQoNCg0KICAgICNpZiBsZW4oZ29vZF93YWZlcl9saXN0KSA+IDAgYW5kIGxlbihiYWRfd2FmZXJfbGlzdCkgPiAwOg0KICAgIGlmIHVwbG9hZF9pZCBpcyBub3QgTm9uZSBhbmQgbGVuKHVwbG9hZF9pZCkgPiAwOg0KDQogICAgICAgICMgZ29vZCB3YWZlciwgYmFkIHdhZmUg5Z2H5pyJ5oyH5a6a77yM6ZyA6KaB5LuO5bGC5bGC5a2X5q6155qE6L+H5ruk55qE5p2h5Lu25LiL6YCJ5oupDQogICAgICAgICMgZ29vZF93YWZlcl9maWx0ZXJfc3FsID0gcHJvY2Vzc19vbmVfa2V5d29yZCgid2FmZXJJZCIsIGdvb2Rfd2FmZXJfbGlzdCkNCiAgICAgICAgIyBiYWRfd2FmZXJfZmlsdGVyX3NxbCA9IHByb2Nlc3Nfb25lX2tleXdvcmQoIndhZmVySWQiLCBiYWRfd2FmZXJfbGlzdCkNCiAgICAgICAgIyAjIG9yIOaLvOaOpQ0KICAgICAgICAjIHdhZmVyX2ZpbHRlcl9zcWwgPSAiIG9yICIuam9pbihbZ29vZF93YWZlcl9maWx0ZXJfc3FsLCBiYWRfd2FmZXJfZmlsdGVyX3NxbF0pDQogICAgICAgICMgd2FmZXJfZmlsdGVyX3NxbCA9IGYiKHt3YWZlcl9maWx0ZXJfc3FsfSkiDQogICAgICAgICMgIyDliqDlhaV3YWZlciDov4fmu6TmnaHku7YNCiAgICAgICAgIyBmaWx0ZXJfc3FsX2xpc3QuYXBwZW5kKHdhZmVyX2ZpbHRlcl9zcWwpDQogICAgICAgIG90aGVyX2tleXdvcmRfZmlsdGVyID0gIiBhbmQgIi5qb2luKGZpbHRlcl9zcWxfbGlzdCkNCg0KICAgICAgICBjYXNlX3doZW5fc3RhdG1lbnQgPSBmIiIiICAoY2FzZQ0KICAgICAgICB3aGVuIGQyLkdCX0ZMQUcgPSAnZ29vZCcgdGhlbiAwIA0KICAgICAgICBlbHNlIDENCiAgICAgICAgZW5kICkgYXMgbGFiZWwNCiAgICAgICAgIiIiDQoNCiAgICAgICAgZmlsdGVyX3NxbF9jb25jYXQgPSBjb25jYXRfdGltZV9maWx0ZXJfc3FsX3dpdGhfb3RoZXJfa2V5d29yZF9zcWwodGltZV9maWx0ZXJfc3FsLCBvdGhlcl9rZXl3b3JkX2ZpbHRlcikNCg0KICAgICAgICBpZiBmaWx0ZXJfc3FsX2NvbmNhdCAhPSAnJzoNCiAgICAgICAgICAgIHNlbGVjdF9zcWwgPSBmIiIic2VsZWN0ICosIHtjYXNlX3doZW5fc3RhdG1lbnR9IGZyb20ge3RhYmxlX25hbWV9IGQxICANCiAgICAgICAgICAgIGpvaW4gZXRsLlVQTE9BREVEX1dBRkVSIGQyDQogICAgICAgIG9uIGQxLldBRkVSX0lEID0gZDIuV0FGRVJfSUQNCg0KICAgICAgICAgICAgd2hlcmUge2ZpbHRlcl9zcWxfY29uY2F0fSBhbmQgZDIuVVBMT0FEX0lEID0gJ3t1cGxvYWRfaWR9JyIiIg0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgc2VsZWN0X3NxbCA9IGYiIiJzZWxlY3QgKiwge2Nhc2Vfd2hlbl9zdGF0bWVudH0gZnJvbSB7dGFibGVfbmFtZX0gZDEgIA0KICAgICAgICAgICAgam9pbiBldGwuVVBMT0FERURfV0FGRVIgZDINCiAgICAgICAgb24gZDEuV0FGRVJfSUQgPSBkMi5XQUZFUl9JRCB3aGVyZSBkMi5VUExPQURfSUQgPSAne3VwbG9hZF9pZH0nIiIiDQoNCiAgICBlbHNlOiANCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZ29vZCBiYWQgd2FmZXIg6YO95b+F6aG76YCJ77yBIikNCg0KICAgICMgZWxpZiBsZW4oZ29vZF93YWZlcl9saXN0KSA+IDAgYW5kIGxlbihiYWRfd2FmZXJfbGlzdCkgPT0gMDoNCiAgICAjICAgICAjIOmAiWdvb2QsIOWJqeS9meS4uiBiYWQNCg0KICAgICMgICAgIG90aGVyX2tleXdvcmRfZmlsdGVyID0gIiBhbmQgIi5qb2luKGZpbHRlcl9zcWxfbGlzdCkNCiAgICAjICAgICBnb29kX3dhZmVyX2ZpbHRlcl9zcWwgPSBwcm9jZXNzX29uZV9rZXl3b3JkKCJ3YWZlcklkIiwgZ29vZF93YWZlcl9saXN0KQ0KDQogICAgIyAgICAgY2FzZV93aGVuX3N0YXRtZW50ID0gZiIoY2FzZSB3aGVuIHtnb29kX3dhZmVyX2ZpbHRlcl9zcWx9IHRoZW4gMCBlbHNlIDEgIGVuZCApIGxhYmVsIg0KICAgICMgICAgIGZpbHRlcl9zcWxfY29uY2F0ID0gY29uY2F0X3RpbWVfZmlsdGVyX3NxbF93aXRoX290aGVyX2tleXdvcmRfc3FsKHRpbWVfZmlsdGVyX3NxbCwgb3RoZXJfa2V5d29yZF9maWx0ZXIpDQogICAgIyAgICAgc2VsZWN0X3NxbCA9IGYic2VsZWN0ICosIHtjYXNlX3doZW5fc3RhdG1lbnR9IGZyb20ge3RhYmxlX25hbWV9IHdoZXJlIHtmaWx0ZXJfc3FsX2NvbmNhdH0iDQoNCiAgICAjIGVsaWYgbGVuKGdvb2Rfd2FmZXJfbGlzdCkgPT0gMCBhbmQgbGVuKGJhZF93YWZlcl9saXN0KSA+IDA6DQogICAgIyAgICAgIyDpgIliYWQsIOWJqeS9meS4umdvb2QNCiAgICAjICAgICBvdGhlcl9rZXl3b3JkX2ZpbHRlciA9ICIgYW5kICIuam9pbihmaWx0ZXJfc3FsX2xpc3QpDQogICAgIyAgICAgYmFkX3dhZmVyX2ZpbHRlcl9zcWwgPSBwcm9jZXNzX29uZV9rZXl3b3JkKCJ3YWZlcklkIiwgYmFkX3dhZmVyX2xpc3QpDQogICAgIyAgICAgY2FzZV93aGVuX3N0YXRtZW50ID0gZiIiIihjYXNlIHdoZW4ge2JhZF93YWZlcl9maWx0ZXJfc3FsfSB0aGVuIDEgZWxzZSAwIGVuZCApIGxhYmVsIiIiDQogICAgIyAgICAgZmlsdGVyX3NxbF9jb25jYXQgPSBjb25jYXRfdGltZV9maWx0ZXJfc3FsX3dpdGhfb3RoZXJfa2V5d29yZF9zcWwodGltZV9maWx0ZXJfc3FsLCBvdGhlcl9rZXl3b3JkX2ZpbHRlcikNCiAgICAjICAgICBzZWxlY3Rfc3FsID0gZiJzZWxlY3QgKiwge2Nhc2Vfd2hlbl9zdGF0bWVudH0gZnJvbSB7dGFibGVfbmFtZX0gd2hlcmUge2ZpbHRlcl9zcWxfY29uY2F0fSINCiAgICAjICAgICAjIGNhc2UxIHN0YXQgcmVzdWx0cyDooajmsqHmnIljYXNlX2luZm8g5pe26Ze05YiX77yM5pqC5pe25Y675o6JDQogICAgICAgICMgc2VsZWN0X3NxbCA9IGYic2VsZWN0ICosIHtjYXNlX3doZW5fc3RhdG1lbnR9IGZyb20ge3RhYmxlX25hbWV9IHdoZXJlIHtvdGhlcl9rZXl3b3JkX2ZpbHRlcn0iDQoNCiAgICAjIHByaW50KHNlbGVjdF9zcWwpICAgIA0KICAgIHNlbGVjdF9zcWwgPSBzZWxlY3Rfc3FsLnJlcGxhY2UoIioiLCAgImQxLldBRkVSX0lELCBkMS5UT09MX0lELCBkMS5SVU5fSUQsIGQxLkVRUF9OQU1FLCBkMS5QUk9EVUNUX0lELCBkMS5QUk9ERzEsIGQxLlRPT0xfTkFNRSwgZDEuTE9UX0lELCBkMS5SRUNJUEVfTkFNRSwgZDEuT1BFUl9OTywgZDEucGFyYW1ldHJpY19uYW1lLCBkMS5DQVNFX0lORk8sIGQxLlNUQVRVUywgZDEuU1RBVElTVElDX1JFU1VMVCIpDQogICAgaWYgdGFibGVfbmFtZSA9PSAiZXRsLkRXRF9QT0NfQ0FTRV9GRF9VVkFfREFUQV9URVNUIjoNCiAgICAgICAgc2VsZWN0X3NxbCA9IGYie3NlbGVjdF9zcWx9IGFuZCBkMS5TVEFUVVMgIT0gJ0VSUk9SJyINCiAgICBwcmludCgic2VsZWN0X3NxbCIsIHNlbGVjdF9zcWwpIA0KICAgIHJldHVybiBzZWxlY3Rfc3FsDQogDQoNCg0KZGVmIGdldF9kYXRhX2Zyb21fZG9yaXMoc2VsZWN0X2NvbmRpdGlvbl9saXN0LCB0YWJsZV9uYW1lKToNCiAgICBzZWxlY3RfZGZfbGlzdCA9IFtyZWFkX3NxbCh0cmFuc19zZWxlY3RfY29uZGl0aW9uX3RvX3NxbF93aXRoX2xhYmVsKHNlbGVjdF9jb25kaXRpb25fZGljdCwgdGFibGVfbmFtZSkpIGZvciBzZWxlY3RfY29uZGl0aW9uX2RpY3QgaW4gc2VsZWN0X2NvbmRpdGlvbl9saXN0XQ0KICAgICMg5aSa5Liq6L+b6KGMdW5pb24NCiAgICBkZjEgPSByZWR1Y2UoRGF0YUZyYW1lLnVuaW9uQWxsLCBzZWxlY3RfZGZfbGlzdCkNCiAgICByZXR1cm4gZGYxDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj5LuOa2Fma2Hmtojmga/or7vlj5bpnIDopoHnmoTotYTmlpkjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQpkZWYgZ2V0X3NvbWVfaW5mbyhkZjpwZC5EYXRhRnJhbWUpOg0KICAgIGlmIGxlbihkZikgPiAwOg0KICAgICAgICBkZiA9IGRmLmhlYWQoMSkNCg0KICAgIHJlcXVlc3RfaWQgPSBkZlsicmVxdWVzdElkIl0udmFsdWVzWzBdDQogICAgcmVxdWVzdF9wYXJhbXMgPSBkZlsicmVxdWVzdFBhcmFtIl0udmFsdWVzWzBdDQogICAgIyDpgb/lhY3lrZjlnKjljZXlvJXlj7fvvIzlm6DkuLpqc29uIOW8leWPt+WPquacieWPjOW8leWPtw0KICAgIHJlcXVlc3RfcGFyYW1zID0gcmVxdWVzdF9wYXJhbXMucmVwbGFjZSgnXCcnLCAiXCIiKSAgIA0KICAgIHBhcnNlX2RpY3QgPSBqc29uLmxvYWRzKHJlcXVlc3RfcGFyYW1zKQ0KICAgIG1lcmdlX3Byb2RnMSA9IHBhcnNlX2RpY3RbMF1bJ21lcmdlUHJvZGcxJ10NCiAgICANCiAgICB0cnk6DQogICAgICAgIG1lcmdlX29wZXJubyA9IGxpc3QocGFyc2VfZGljdFswXVsnbWVyZ2VPcGVybm8nXSkNCiAgICBleGNlcHQgS2V5RXJyb3I6DQogICAgICAgIG1lcmdlX29wZXJubyA9IE5vbmUNCg0KICAgIGlmIG1lcmdlX3Byb2RnMSA9PSAnMSc6DQogICAgICAgIGdycGJ5X2xpc3QgPSBbJ09QRVJfTk8nLCAnVE9PTF9OQU1FJ10NCiAgICBlbGlmIG1lcmdlX3Byb2RnMSA9PSAnMCc6DQogICAgICAgIGdycGJ5X2xpc3QgPSBbJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRSddDQogICAgZWxzZToNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcg0KICAgIHJldHVybiBwYXJzZV9kaWN0LCByZXF1ZXN0X2lkLCBncnBieV9saXN0LCBtZXJnZV9vcGVybm8NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+iejeWQiE9QRVJfTk/lrZfmrrUjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KZGVmIGludGVncmF0ZV9vcGVybm8oZGYsIG1lcmdlX29wZXJub19saXN0KToNCiAgICBpZiBtZXJnZV9vcGVybm9fbGlzdCBpcyBub3QgTm9uZSBhbmQgbGVuKG1lcmdlX29wZXJub19saXN0KSA+IDA6DQogICAgICAgICMg5bCGbWVyZ2VPcGVybm/kuK3mr4/kuKrlrZflhbjnmoR2YWx1ZXPmj5Dlj5blh7rmnaXvvIznu4TmiJDkuIDkuKrliJfooagNCiAgICAgICAgdmFsdWVzX3RvX3JlcGxhY2UgPSBbbGlzdChydWxlLnZhbHVlcygpKVswXSBmb3IgcnVsZSBpbiBtZXJnZV9vcGVybm9fbGlzdF0NCg0KICAgICAgICAjIOWwhuavj+S4gOS4quWtl+WFuOS4reeahHZhbHVlc+aLvOaOpei1t+adpQ0KICAgICAgICBtZXJnZWRfdmFsdWVzID0gWyJfIi5qb2luKCBsaXN0KHJ1bGUudmFsdWVzKCkpWzBdKSBmb3IgcnVsZSBpbiBtZXJnZV9vcGVybm9fbGlzdF0NCg0KICAgICAgICBmb3IgdmFsdWVzLCByZXBsYWNlbWVudF92YWx1ZSBpbiB6aXAodmFsdWVzX3RvX3JlcGxhY2UsIG1lcmdlZF92YWx1ZXMpOg0KICAgICAgICAgICAgZGYgPSBkZi53aXRoQ29sdW1uKCJPUEVSX05PIiwgd2hlbihjb2woIk9QRVJfTk8iKS5pc2luKHZhbHVlcyksIHJlcGxhY2VtZW50X3ZhbHVlKS5vdGhlcndpc2UoY29sKCJPUEVSX05PIikpKQ0KICAgICAgICByZXR1cm4gZGYNCiAgICBlbHNlOg0KICAgICAgICByZXR1cm4gZGYNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI0ZEQ+aVsOaNrumihOWkhOeQhiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCmRlZiBfcHJlX3Byb2Nlc3MoZGYpOg0KICAgICIiIg0KICAgIHBhcmFtIGRmOiDku47mlbDmja7lupPkuK3or7vlj5blh7rmnaXnmoTmn5DkuKpDQVNF5pWw5o2uDQogICAgcmV0dXJuOiDmlbDmja7pooTlpITnkIbvvIzlkI7pnaLopoHmoLnmja7lrp7pmYXmg4XlhrXnu5/kuIDmt7vliqANCiAgICAiIiINCiAgICAjIOWPqumAieWHuuS8mueUqOWIsOeahOWIlw0KICAgIGRmID0gZGYuc2VsZWN0KCdXQUZFUl9JRCcsICdUT09MX0lEJywgJ1JVTl9JRCcsICdFUVBfTkFNRScsICdQUk9EVUNUX0lEJywgJ1BST0RHMScsICdUT09MX05BTUUnLA0KICAgICAgICAgICAgICAgICAgICdPUEVSX05PJywgJ3BhcmFtZXRyaWNfbmFtZScsICdTVEFUSVNUSUNfUkVTVUxUJywgJ2xhYmVsJykNCiAgICAjIOWJlOmZpE5B5YC8DQogICAgZGYgPSBkZi5maWx0ZXIoY29sKCdTVEFUSVNUSUNfUkVTVUxUJykuaXNOb3ROdWxsKCkpDQogICAgIyDmjInnhafmiYDmnInnmoTooYzov5vooYzljrvph40NCiAgICBkZjEgPSBkZi5kcm9wRHVwbGljYXRlcygpDQogICAgIyDpgInmnIDmlrDnmoRSVU4NCiAgICBkZjIgPSBkZjEuZ3JvdXBCeSgnV0FGRVJfSUQnLCAnT1BFUl9OTycsICdUT09MX0lEJykuYWdnKG1heCgnUlVOX0lEJykuYWxpYXMoJ1JVTl9JRCcpKQ0KICAgIGRmX3J1biA9IGRmMS5qb2luKGRmMi5kcm9wRHVwbGljYXRlcyhzdWJzZXQ9WydXQUZFUl9JRCcsICdPUEVSX05PJywgJ1RPT0xfSUQnLCAnUlVOX0lEJ10pLA0KICAgICAgICAgICAgICAgICAgICAgIG9uPVsnV0FGRVJfSUQnLCAnT1BFUl9OTycsICdUT09MX0lEJywgJ1JVTl9JRCddLCBob3c9J2lubmVyJykNCiAgICByZXR1cm4gZGZfcnVuDQoNCg0KDQpkZWYgY29tbW9uYWxpdHlfYW5hbHlzaXMoZGZfcnVuLCBncnBieV9saXN0KToNCiAgICAiIiINCiAgICBwYXJhbSBkZl9ydW46IOaVsOaNrumihOWkhOeQhuWQjueahOaVsOaNrg0KICAgIHJldHVybjog5YWx5oCn5YiG5p6Q5ZCO55qE57uT5p6c77yMIOi/lOWbnmJhZCB3YWZlcuWJjeWNgeeahOe7hOWQiA0KICAgICIiIg0KICAgIGdycHMgPSAoZGZfcnVuLmdyb3VwQnkoZ3JwYnlfbGlzdCkNCiAgICAgICAgICAgIC5hZ2coY291bnREaXN0aW5jdCgnV0FGRVJfSUQnKS5hbGlhcygnd2FmZXJfY291bnQnKSwNCiAgICAgICAgICAgICAgICAgY291bnREaXN0aW5jdCgnV0FGRVJfSUQnLCB3aGVuKGRmX3J1blsnbGFiZWwnXSA9PSAwLCAxKSkuYWxpYXMoJ2dvb2RfbnVtJyksDQogICAgICAgICAgICAgICAgIGNvdW50RGlzdGluY3QoJ1dBRkVSX0lEJywgd2hlbihkZl9ydW5bJ2xhYmVsJ10gPT0gMSwgMSkpLmFsaWFzKCdiYWRfbnVtJykpDQogICAgICAgICAgICAub3JkZXJCeSgnYmFkX251bScsIGFzY2VuZGluZz1GYWxzZSkpDQoNCiAgICAjIOWNleermeeCuSvljZXohZTlrqTnmoTmg4XlhrUNCiAgICBpZiBncnBzLmNvdW50KCkgPT0gMToNCiAgICAgICAgcmV0dXJuIGdycHMNCiAgICBlbHNlOg0KICAgICAgICBncnBzID0gZ3Jwcy5maWx0ZXIoZ3Jwc1snYmFkX251bSddID4gMCkNCiAgICAgICAgd2luZG93X3NlcCA9IFdpbmRvdygpLm9yZGVyQnkoY29sKCJiYWRfbnVtIikuZGVzYygpKQ0KICAgICAgICByYW5rZWRfZGYgPSBncnBzLndpdGhDb2x1bW4oInJhbmsiLCByYW5rKCkub3Zlcih3aW5kb3dfc2VwKSkNCiAgICAgICAgZ3Jwc3MgPSByYW5rZWRfZGYuZmlsdGVyKGNvbCgicmFuayIpIDw9IDEwKS5kcm9wKCJyYW5rIikNCiAgICAgICAgcmV0dXJuIGdycHNzDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj6I635Y+W5qC35pys5pWw5o2uIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KZGVmIGdldF9kYXRhX2xpc3QoY29tbW9uX3JlcywgZ3JwYnlfbGlzdCwgYmlnX29yX3NtYWxsPSdiaWcnKToNCiAgICAiIiINCiAgICBwYXJhbSBjb21tb25fcmVzOiDlhbHmgKfliIbmnpDlkI7nmoTnu5PmnpwsIOaMieeFp+Wkp+agt+acrOaIluiAheWwj+agt+acrOadoeS7tuetm+mAieWHuue7hOWQiA0KICAgIHBhcmFtIGdycGJ5X2xpc3Q6IOaMieeFp1BST0RHMStPUEVSX05PK1RPT0xfTkFNReWIhue7hOaIlk9QRVJfTk8rVE9PTF9OQU1F5YiG57uEDQogICAgcGFyYW0gYmlnX29yX3NtYWxsOiBiaWfmiJbogIVzbWFsbA0KICAgIHJldHVybjog5a+55bqU57uE5ZCI55qE5a2X5YW45b2i5byPLCDljIXlnKjkuIDkuKrlpKfliJfooajkuK0NCiAgICAiIiINCiAgICBhc3NlcnQgYmlnX29yX3NtYWxsIGluIFsnYmlnJywgJ3NtYWxsJ10sICLlj6rog73pgInmi6liaWfmiJbogIVzbWFsbCwg6K+35qOA5p+l5ou85YaZIg0KICAgIGlmIGJpZ19vcl9zbWFsbCA9PSAnYmlnJzoNCiAgICAgICAgZ29vZF9iYWRfZ3JwcyA9IGNvbW1vbl9yZXMuZmlsdGVyKCJnb29kX251bSA+PSAzIEFORCBiYWRfbnVtID49IDMiKQ0KICAgIGVsc2U6DQogICAgICAgIGdvb2RfYmFkX2dycHMgPSBjb21tb25fcmVzLmZpbHRlcigiYmFkX251bSA+PSAxIEFORCB3YWZlcl9jb3VudCA+PTIiKQ0KICAgIGdvb2RfYmFkX2dycHMgPSBnb29kX2JhZF9ncnBzLm9yZGVyQnkoY29sKCJiYWRfbnVtIikuZGVzYygpLCBjb2woIndhZmVyX2NvdW50IikuZGVzYygpLCBjb2woImdvb2RfbnVtIikuZGVzYygpKS5saW1pdCg1KQ0KDQogICAgaWYgJ1BST0RHMScgaW4gZ3JwYnlfbGlzdDoNCiAgICAgICAgZGF0YV9saXN0ID0gZ29vZF9iYWRfZ3Jwc1snUFJPREcxJywgJ09QRVJfTk8nLCAnVE9PTF9OQU1FJ10uY29sbGVjdCgpICANCiAgICBlbHNlOg0KICAgICAgICBkYXRhX2xpc3QgPSBnb29kX2JhZF9ncnBzWydPUEVSX05PJywgJ1RPT0xfTkFNRSddLmNvbGxlY3QoKQ0KDQogICAgZGF0YV9kaWN0X2xpc3QgPSBbcm93LmFzRGljdCgpIGZvciByb3cgaW4gZGF0YV9saXN0XQ0KICAgIHJldHVybiBkYXRhX2RpY3RfbGlzdA0KDQoNCmRlZiBnZXRfdHJhaW5fZGF0YShkZl9ydW4sIGRhdGFfZGljdF9saXN0KToNCiAgICAiIiINCiAgICBwYXJhbSBkZl9ydW46IOaVsOaNrumihOWkhOeQhuWQjueahOaVsOaNrg0KICAgIHBhcmFtIGRhdGFfZGljdDog562b6YCJ5ZCO55qE5a2X5YW457uT5p6cDQogICAgcmV0dXJuOiDku47ljp/lp4vmlbDmja7kuK3ov4fmu6Tlh7rnnJ/mraPnlKjmnaXlu7rmqKHnmoTnu4TlkIjmlbDmja4NCiAgICAiIiINCiAgICBpZiBsZW4oZGF0YV9kaWN0X2xpc3RbMF0pID09IDM6DQogICAgICAgIHByb2QsIG9wZXIsIHRvb2wgPSBkYXRhX2RpY3RfbGlzdFswXVsnUFJPREcxJ10sIGRhdGFfZGljdF9saXN0WzBdWydPUEVSX05PJ10sIGRhdGFfZGljdF9saXN0WzBdWydUT09MX05BTUUnXQ0KICAgICAgICBkZl9zID0gZGZfcnVuLmZpbHRlcigiUFJPREcxID09ICd7fScgQU5EIE9QRVJfTk8gPT0gJ3t9JyBBTkQgVE9PTF9OQU1FID09ICd7fSciLmZvcm1hdChwcm9kLCBvcGVyLCB0b29sKSkNCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMSwgbGVuKGRhdGFfZGljdF9saXN0KSk6DQogICAgICAgICAgICBwcm9kLCBvcGVyLCB0b29sID0gZGF0YV9kaWN0X2xpc3RbaV1bJ1BST0RHMSddLCBkYXRhX2RpY3RfbGlzdFtpXVsnT1BFUl9OTyddLCBkYXRhX2RpY3RfbGlzdFtpXVsnVE9PTF9OQU1FJ10NCiAgICAgICAgICAgIGRmX20gPSBkZl9ydW4uZmlsdGVyKCJQUk9ERzEgPT0gJ3t9JyBBTkQgT1BFUl9OTyA9PSAne30nIGFuZCBUT09MX05BTUUgPT0gJ3t9JyIuZm9ybWF0KHByb2QsIG9wZXIsIHRvb2wpKQ0KICAgICAgICAgICAgZGZfcyA9IGRmX3MudW5pb24oZGZfbSkNCiAgICBlbHNlOg0KICAgICAgICBvcGVyLCB0b29sID0gZGF0YV9kaWN0X2xpc3RbMF1bJ09QRVJfTk8nXSwgZGF0YV9kaWN0X2xpc3RbMF1bJ1RPT0xfTkFNRSddDQogICAgICAgIGRmX3MgPSBkZl9ydW4uZmlsdGVyKCJPUEVSX05PID09ICd7fScgQU5EIFRPT0xfTkFNRSA9PSAne30nIi5mb3JtYXQob3BlciwgdG9vbCkpDQogICAgICAgIGZvciBpIGluIHJhbmdlKDEsIGxlbihkYXRhX2RpY3RfbGlzdCkpOg0KICAgICAgICAgICAgb3BlciwgdG9vbCA9IGRhdGFfZGljdF9saXN0W2ldWydPUEVSX05PJ10sIGRhdGFfZGljdF9saXN0W2ldWydUT09MX05BTUUnXQ0KICAgICAgICAgICAgZGZfbSA9IGRmX3J1bi5maWx0ZXIoIk9QRVJfTk8gPT0gJ3t9JyBhbmQgVE9PTF9OQU1FID09ICd7fSciLmZvcm1hdChvcGVyLCB0b29sKSkNCiAgICAgICAgICAgIGRmX3MgPSBkZl9zLnVuaW9uKGRmX20pDQogICAgcmV0dXJuIGRmX3MNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj6I635Y+W5Lyg5YWl55qE5pW05Liq5pWw5o2u5Lit55qE5omA5pyJYmFkX3dhZmVy5Liq5pWwIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQpkZWYgZ2V0X2FsbF9iYWRfd2FmZXJfbnVtKGRmKToNCiAgICAiIiINCiAgICBwYXJhbSBkZjog562b6YCJ5ZCO55qE5pWw5o2uDQogICAgcmV0dXJuOiDmlbDmja7kuK3miYDmnIliYWRfd2FmZXLnmoTmlbDph48NCiAgICAiIiINCiAgICByZXR1cm4gZGYuZmlsdGVyKCJsYWJlbCA9PSAxIikuc2VsZWN0KCdXQUZFUl9JRCcpLmRpc3RpbmN0KCkuY291bnQoKQ0KDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjI+WvuWdvb2Q+PTPlkoxiYWQ+PTPnmoTmlbDmja7vvIznlKhyZuW7uuaooSMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCmRlZiBnZXRfcGl2b3RfdGFibGUoZGYsIGJ5KToNCiAgICAiIiINCiAgICBwYXJhbSBkZjog5aSn5qC35pys57uE5ZCI55qE5pWw5o2uDQogICAgcGFyYW0gYnk6IOWIhue7hOWtl+autQ0KICAgIHJldHVybjog6KGo5qC86YCP6KeG5ZCO55qE57uT5p6cDQogICAgIiIiDQogICAgaWYgbGVuKGJ5KSA9PSAzOg0KICAgICAgICBkZl9waXZvdCA9IGRmLmRyb3BuYShheGlzPTApLnBpdm90X3RhYmxlKGluZGV4PVsnV0FGRVJfSUQnLCAnbGFiZWwnXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnM9WydPUEVSX05PJywgJ1RPT0xfTkFNRScsICdwYXJhbWV0cmljX25hbWUnLCAnUFJPREcxJ10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcz1bJ1NUQVRJU1RJQ19SRVNVTFQnXSkNCiAgICBlbHNlOg0KICAgICAgICBkZl9waXZvdCA9IGRmLmRyb3BuYShheGlzPTApLnBpdm90X3RhYmxlKGluZGV4PVsnV0FGRVJfSUQnLCAnbGFiZWwnXSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnM9WydPUEVSX05PJywgJ1RPT0xfTkFNRScsICdwYXJhbWV0cmljX25hbWUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzPVsnU1RBVElTVElDX1JFU1VMVCddKQ0KICAgIGRmX3Bpdm90LmNvbHVtbnMgPSBkZl9waXZvdC5jb2x1bW5zLm1hcCgnIycuam9pbikNCiAgICBkZl9waXZvdCA9IGRmX3Bpdm90LmZpbGxuYShkZl9waXZvdC5tZWFuKCkpLnJlc2V0X2luZGV4KGRyb3A9RmFsc2UpDQogICAgcmV0dXJuIGRmX3Bpdm90DQoNCg0KDQoNCmRlZiBmaXRfcmZfYmlnX3NhbXBsZShkZiwgYnkpOg0KICAgICIiIg0KICAgIHBhcmFtIGRmOiDlpKfmoLfmnKznu4TlkIjnmoTmlbDmja4NCiAgICBwYXJhbSBieTog5YiG57uE5a2X5q61DQogICAgcmV0dXJuOiBSYW5kb21Gb3Jlc3Tlu7rmqKHlkI7nmoTnu5PmnpwNCiAgICAiIiINCiAgICBzY2hlbWFfYWxsID0gU3RydWN0VHlwZShbDQogICAgICAgIFN0cnVjdEZpZWxkKCJQUk9ERzEiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiT1BFUl9OTyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiYmFkX3dhZmVyIiwgSW50ZWdlclR5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJyb2NfYXVjX3Njb3JlIiwgRmxvYXRUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiZmVhdHVyZXMiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiaW1wb3J0YW5jZSIsIEZsb2F0VHlwZSgpLCBUcnVlKV0pDQoNCiAgICBAcGFuZGFzX3VkZihyZXR1cm5UeXBlPXNjaGVtYV9hbGwsIGZ1bmN0aW9uVHlwZT1QYW5kYXNVREZUeXBlLkdST1VQRURfTUFQKQ0KICAgIGRlZiBnZXRfbW9kZWxfcmVzdWx0KGRmX3J1bik6DQogICAgICAgICMg6KGo5qC86YCP6KeGDQogICAgICAgIGRmX3Bpdm90ID0gZ2V0X3Bpdm90X3RhYmxlKGRmPWRmX3J1biwgYnk9YnkpDQoNCiAgICAgICAgIyDlrprkuYnoh6rlj5jph4/lkozlm6Dlj5jph48NCiAgICAgICAgWF90cmFpbiA9IGRmX3Bpdm90W2RmX3Bpdm90LmNvbHVtbnMuZGlmZmVyZW5jZShbJ1dBRkVSX0lEJywgJ2xhYmVsJ10pLnRvbGlzdCgpXQ0KICAgICAgICB5X3RyYWluID0gZGZfcGl2b3RbWydsYWJlbCddXQ0KDQogICAgICAgIHpfcmF0aW8gPSB5X3RyYWluLnZhbHVlX2NvdW50cyhub3JtYWxpemU9VHJ1ZSkNCiAgICAgICAgZ29vZF9yYXRpbyA9IHpfcmF0aW9bMF0NCiAgICAgICAgYmFkX3JhdGlvID0gel9yYXRpb1sxXQ0KICAgICAgICBpZiBhYnMoZ29vZF9yYXRpbyAtIGJhZF9yYXRpbykgPiAwLjc6DQogICAgICAgICAgICB1bmRlcnNhbXBsZXIgPSBDbHVzdGVyQ2VudHJvaWRzKHJhbmRvbV9zdGF0ZT0xMDEpDQogICAgICAgICAgICBYX3RyYWluLCB5X3RyYWluID0gdW5kZXJzYW1wbGVyLmZpdF9yZXNhbXBsZShYX3RyYWluLCB5X3RyYWluKQ0KDQogICAgICAgICMg572R5qC85pCc57SiDQogICAgICAgIHBpcGUgPSBQaXBlbGluZShzdGVwcz1bDQogICAgICAgICAgICAoJ2ltcHV0ZXInLCBTaW1wbGVJbXB1dGVyKHN0cmF0ZWd5PSdjb25zdGFudCcsIGZpbGxfdmFsdWU9LTk5OSkpLA0KICAgICAgICAgICAgKCdzY2FsZXInLCBTdGFuZGFyZFNjYWxlcigpKSwNCiAgICAgICAgICAgICgnbW9kZWwnLCBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyKCkpXSkNCiAgICAgICAgcGFyYW1fZ3JpZCA9IHsnbW9kZWxfX25fZXN0aW1hdG9ycyc6IFsqcmFuZ2UoNTAsIDEwMCwgMTApXSwNCiAgICAgICAgICAgICAgICAgICAgICAnbW9kZWxfX21heF9kZXB0aCc6IFsqcmFuZ2UoMTAsIDUwLCAxMCldfQ0KICAgICAgICBncmlkID0gR3JpZFNlYXJjaENWKGVzdGltYXRvcj1waXBlLCBzY29yaW5nPSdyb2NfYXVjJywgcGFyYW1fZ3JpZD1wYXJhbV9ncmlkLCBjdj0zLCBuX2pvYnM9LTEpDQogICAgICAgIGdyaWQuZml0KFhfdHJhaW4udmFsdWVzLCB5X3RyYWluLnZhbHVlcy5yYXZlbCgpKQ0KICAgICAgICByb2NfYXVjX3Njb3JlXyA9IGdyaWQuYmVzdF9zY29yZV8NCg0KICAgICAgICAjIOeJueW+gemHjeimgeW6puOAgee7k+aenOaxh+aAuw0KICAgICAgICBzbWFsbF9pbXBvcnRhbmNlX3JlcyA9IHBkLkRhdGFGcmFtZSh7DQogICAgICAgICAgICAnZmVhdHVyZXMnOiBYX3RyYWluLmNvbHVtbnMsDQogICAgICAgICAgICAnaW1wb3J0YW5jZSc6IGdyaWQuYmVzdF9lc3RpbWF0b3JfLnN0ZXBzWzJdWzFdLmZlYXR1cmVfaW1wb3J0YW5jZXNffSkuc29ydF92YWx1ZXMoYnk9J2ltcG9ydGFuY2UnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzY2VuZGluZz1GYWxzZSkNCiAgICAgICAgaWYgbGVuKGJ5KSA9PSAzOg0KICAgICAgICAgICAgc21hbGxfc2FtcGxlX3JlcyA9IHBkLkRhdGFGcmFtZSh7DQogICAgICAgICAgICAgICAgJ1BST0RHMSc6IGRmX3J1blsnUFJPREcxJ10udW5pcXVlKCksDQogICAgICAgICAgICAgICAgJ09QRVJfTk8nOiBkZl9ydW5bJ09QRVJfTk8nXS51bmlxdWUoKSwNCiAgICAgICAgICAgICAgICAnVE9PTF9OQU1FJzogZGZfcnVuWydUT09MX05BTUUnXS51bmlxdWUoKSwNCiAgICAgICAgICAgICAgICAnYmFkX3dhZmVyJzogc3VtKGRmX3Bpdm90WydsYWJlbCddKSwNCiAgICAgICAgICAgICAgICAncm9jX2F1Y19zY29yZSc6IHJvY19hdWNfc2NvcmVffSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIFBST0RHMSA9ICdncnBsZW4yJw0KICAgICAgICAgICAgc21hbGxfc2FtcGxlX3JlcyA9IHBkLkRhdGFGcmFtZSh7DQogICAgICAgICAgICAgICAgJ1BST0RHMSc6IFBST0RHMSwNCiAgICAgICAgICAgICAgICAnT1BFUl9OTyc6IGRmX3J1blsnT1BFUl9OTyddLnVuaXF1ZSgpLA0KICAgICAgICAgICAgICAgICdUT09MX05BTUUnOiBkZl9ydW5bJ1RPT0xfTkFNRSddLnVuaXF1ZSgpLA0KICAgICAgICAgICAgICAgICdiYWRfd2FmZXInOiBzdW0oZGZfcGl2b3RbJ2xhYmVsJ10pLA0KICAgICAgICAgICAgICAgICdyb2NfYXVjX3Njb3JlJzogcm9jX2F1Y19zY29yZV99KQ0KICAgICAgICByZXR1cm4gcGQuY29uY2F0KFtzbWFsbF9pbXBvcnRhbmNlX3Jlcywgc21hbGxfc2FtcGxlX3Jlc10pDQogICAgcmV0dXJuIGRmLmdyb3VwYnkoYnkpLmFwcGx5KGdldF9tb2RlbF9yZXN1bHQpDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+WvuWdvb2Q+PTPlkoxiYWQ+PTPlu7rmqKHlkI7nmoTnu5Pmnpzov5vooYzmlbTlkIgjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQpkZWYgc3BsaXRfc2NvcmVfYmlnX3NhbXBsZShkZiwgYnkpOg0KICAgICIiIg0KICAgIHBhcmFtIGRmOiBSYW5kb21Gb3Jlc3Tlu7rmqKHlkI7nmoTnu5PmnpwNCiAgICBwYXJhbSBieTog5YiG57uE5a2X5q61DQogICAgcmV0dXJuOiByb2NfYXVj5YiG5pWw57uT5p6cDQogICAgIiIiDQogICAgc2NoZW1hX2FsbCA9IFN0cnVjdFR5cGUoW1N0cnVjdEZpZWxkKCJQUk9ERzEiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiT1BFUl9OTyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiYmFkX3dhZmVyIiwgSW50ZWdlclR5cGUoKSwgVHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJyb2NfYXVjX3Njb3JlIiwgRmxvYXRUeXBlKCksIFRydWUpXSkNCg0KICAgIEBwYW5kYXNfdWRmKHJldHVyblR5cGU9c2NoZW1hX2FsbCwgZnVuY3Rpb25UeXBlPVBhbmRhc1VERlR5cGUuR1JPVVBFRF9NQVApDQogICAgZGVmIGdldF9yZXN1bHQobW9kZWxfcmVzdWx0cyk6DQogICAgICAgIHNhbXBsZV9yZXMgPSBtb2RlbF9yZXN1bHRzW1snUFJPREcxJywgJ09QRVJfTk8nLCAnVE9PTF9OQU1FJywgJ2JhZF93YWZlcicsICdyb2NfYXVjX3Njb3JlJ11dLmRyb3BuYShheGlzPTApDQogICAgICAgIHNhbXBsZV9yZXMgPSBzYW1wbGVfcmVzW3NhbXBsZV9yZXNbJ3JvY19hdWNfc2NvcmUnXSA+IDAuNl0NCiAgICAgICAgcmV0dXJuIHNhbXBsZV9yZXMNCiAgICByZXR1cm4gZGYuZ3JvdXBieShieSkuYXBwbHkoZ2V0X3Jlc3VsdCkNCg0KDQoNCmRlZiBzcGxpdF9mZWF0dXJlcyhkZiwgaW5kZXgpIC0+IHN0cjoNCiAgICAiIiINCiAgICBwYXJhbSBkZjogUmFuZG9tRm9yZXN05bu65qih5ZCO55qEZmVhdHVyZV9pbXBvcnRhbmNlX3RhYmxlDQogICAgcGFyYW0gaW5kZXg6IOmhuuW6j+WAvA0KICAgIHJldHVybjog5a2X5q615bGe5oCn5YC8DQogICAgIiIiDQogICAgcmV0dXJuIGRmWydmZWF0dXJlcyddLmFwcGx5KGxhbWJkYSB4OiB4LnNwbGl0KCcjJylbaW5kZXhdKQ0KDQoNCmRlZiBnZXRfc3BsaXRfZmVhdHVyZV9pbXBvcnRhbmNlX3RhYmxlKGRmLCBieSk6DQogICAgIiIiDQogICAgcGFyYW0gZGY6IFJhbmRvbUZvcmVzdOW7uuaooeWQjueahGZlYXR1cmVfaW1wb3J0YW5jZV90YWJsZQ0KICAgIHBhcmFtIGJ5OiBPUEVSX05PK1RPT0xfTkFNRStQUk9ERzHmiJbogIVPUEVSX05PK1RPT0xfTkFNRQ0KICAgIHJldHVybjog5YiG6KOCZmVhdHVyZXPlkI7nmoTooagNCiAgICAiIiINCiAgICBkZlsnU1RBVElTVElDX1JFU1VMVCddID0gc3BsaXRfZmVhdHVyZXMoZGYsIDApDQogICAgZGZbJ09QRVJfTk8nXSA9IHNwbGl0X2ZlYXR1cmVzKGRmLCAxKQ0KICAgIGRmWydUT09MX05BTUUnXSA9IHNwbGl0X2ZlYXR1cmVzKGRmLCAyKQ0KICAgIGRmWydwYXJhbWV0cmljX25hbWUnXSA9IHNwbGl0X2ZlYXR1cmVzKGRmLCAzKQ0KICAgIGRmWydzdGVwJ10gPSBzcGxpdF9mZWF0dXJlcyhkZiwgNCkNCiAgICBkZlsnc3RhdHMnXSA9IHNwbGl0X2ZlYXR1cmVzKGRmLCA1KQ0KDQogICAgaWYgJ1BST0RHMScgaW4gYnk6DQogICAgICAgIGRmWydQUk9ERzEnXSA9IHNwbGl0X2ZlYXR1cmVzKGRmLCA2KQ0KICAgIGVsc2U6DQogICAgICAgIGRmID0gZGYuYXNzaWduKFBST0RHMSA9ICdncnBsZW4yJykNCg0KICAgIGRmID0gZGYuZHJvcChbJ2ZlYXR1cmVzJywgJ1NUQVRJU1RJQ19SRVNVTFQnXSwgYXhpcz0xKS5yZXNldF9pbmRleChkcm9wPVRydWUpDQogICAgcmV0dXJuIGRmDQoNCg0KZGVmIGFkZF9mZWF0dXJlX3N0YXRzKGRmKToNCiAgICAiIiINCiAgICBwYXJhbSBkZjog57uP6L+H5aSE55CG5ZCO55qEZmVhdHVyZV9pbXBvcnRhbmNlX3RhYmxlDQogICAgcmV0dXJuOiDmlrDlop7kuIDliJfvvIzlkKvmnInlj4LmlbDnmoTmiYDmnInnu5/orqHnibnlvoE6ZmVhdHVyZV9zdGF0cw0KICAgICIiIg0KICAgIGZlYXR1cmVfc3RhdHMgPSBkZi5ncm91cGJ5KFsnUFJPREcxJywgJ09QRVJfTk8nLCAnVE9PTF9OQU1FJywgJ3BhcmFtZXRyaWNfbmFtZScsICdzdGVwJ10pWydzdGF0cyddLnVuaXF1ZSgpLnJlc2V0X2luZGV4KCkNCiAgICBmZWF0dXJlX3N0YXRzWydzdGF0cyddID0gW2ZlYXR1cmVfc3RhdHNbJ3N0YXRzJ10uaWxvY1tpXS50b2xpc3QoKSBmb3IgaSBpbiByYW5nZShsZW4oZmVhdHVyZV9zdGF0cykpXQ0KICAgIGZlYXR1cmVfc3RhdHNbJ3N0YXRzJ10gPSBmZWF0dXJlX3N0YXRzWydzdGF0cyddLmFwcGx5KGxhbWJkYSB4OiAiIyIuam9pbih4KSkNCiAgICBmZWF0dXJlX3N0YXRzID0gZmVhdHVyZV9zdGF0cy5hc3NpZ24ocGFyYW1ldHJpY19uYW1lPWxhbWJkYSB4OiB4WydwYXJhbWV0cmljX25hbWUnXStzdHIoJyMnKSt4WydzdGVwJ10pLmRyb3AoJ3N0ZXAnLCBheGlzPTEpDQogICAgcmV0dXJuIGZlYXR1cmVfc3RhdHMNCiAgICANCiAgICANCmRlZiBzcGxpdF9jYWxjdWxhdGVfZmVhdHVyZXNfYmlnX3NhbXBsZShkZiwgYnkpOg0KICAgICIiIg0KICAgIHBhcmFtIGRmOiBSYW5kb21Gb3Jlc3Tlu7rmqKHlkI7nmoTnu5PmnpwNCiAgICBwYXJhbSBieTog5YiG57uE5a2X5q61DQogICAgcmV0dXJuOiBmZWF0dXJlc+WSjGltcG9ydGFuY2Xnu5PmnpwNCiAgICAiIiINCiAgICBzY2hlbWFfYWxsID0gU3RydWN0VHlwZShbDQogICAgICAgIFN0cnVjdEZpZWxkKCJQUk9ERzEiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiT1BFUl9OTyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgicGFyYW1ldHJpY19uYW1lIiwgU3RyaW5nVHlwZSgpLCBUcnVlKSwNCiAgICAgICAgU3RydWN0RmllbGQoImltcG9ydGFuY2UiLCBGbG9hdFR5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJzdGF0cyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSldKQ0KDQogICAgQHBhbmRhc191ZGYocmV0dXJuVHlwZT1zY2hlbWFfYWxsLCBmdW5jdGlvblR5cGU9UGFuZGFzVURGVHlwZS5HUk9VUEVEX01BUCkNCiAgICBkZWYgZ2V0X3Jlc3VsdChtb2RlbF9yZXN1bHRzKToNCiAgICAgICAgIyDlhYjku47pmo/mnLrmo67mnpfnmoTmqKHlnovnu5PmnpzkuK3lj5blh7rljIXlkKtmZWF0dXJlc+WSjGltcG9ydGFuY2XnmoRkYXRhZnJhbWUNCiAgICAgICAgZmVhdHVyZV9pbXBvcnRhbmNlX3RhYmxlID0gbW9kZWxfcmVzdWx0c1tbJ2ZlYXR1cmVzJywgJ2ltcG9ydGFuY2UnXV0uZHJvcG5hKGF4aXM9MCkNCg0KICAgICAgICAjIOWIhuijgmZlYXR1cmVzDQogICAgICAgIGZlYXR1cmVfaW1wb3J0YW5jZV9yZXNfc3BsaXQgPSBnZXRfc3BsaXRfZmVhdHVyZV9pbXBvcnRhbmNlX3RhYmxlKGZlYXR1cmVfaW1wb3J0YW5jZV90YWJsZSwgYnkpDQoNCiAgICAgICAgIyDljrvpmaRpbXBvcnRhbmNl5Li6MOeahOe7hOWQiA0KICAgICAgICBmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0X2Ryb3AgPSBmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0LnF1ZXJ5KCJpbXBvcnRhbmNlID4gMCIpLnJlc2V0X2luZGV4KGRyb3A9VHJ1ZSkNCg0KICAgICAgICAjIOWPluavj+S4gOenjee7hOWQiOe7k+aenOeahOWJjTYwJeaIluiAhTEwMCUNCiAgICAgICAgZmVhdHVyZV9pbXBvcnRhbmNlX3Jlc19zcGxpdF9ubGFyZ2VzdCA9IChmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0X2Ryb3AuZ3JvdXBieShieT1bJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRSddKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwbHkobGFtYmRhIHg6IHgubmxhcmdlc3QoaW50KHguc2hhcGVbMF0qMC42KSwgJ2ltcG9ydGFuY2UnKSBpZiB4LnNoYXBlWzBdPjEgZWxzZSB4Lm5sYXJnZXN0KGludCh4LnNoYXBlWzBdKjEpLCAnaW1wb3J0YW5jZScpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVzZXRfaW5kZXgoZHJvcD1UcnVlKSkNCg0KICAgICAgICAjIOaWsOWinuS4gOWIl++8jOWQq+acieWPguaVsOeahOaJgOaciee7n+iuoeeJueW+gTpmZWF0dXJlX3N0YXRzDQogICAgICAgIGZlYXR1cmVfc3RhdHMgPSBhZGRfZmVhdHVyZV9zdGF0cyhmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0X2Ryb3ApDQoNCiAgICAgICAgIyDlr7nlkIzkuIDnp43nu4TlkIjph4znmoTlkIzkuIDkuKrlj4LmlbDov5vooYzmsYLlkow6ZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnkNCiAgICAgICAgZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnkgPSAoZmVhdHVyZV9pbXBvcnRhbmNlX3Jlc19zcGxpdF9ubGFyZ2VzdC5ncm91cGJ5KFsnUFJPREcxJywgJ09QRVJfTk8nLCAnVE9PTF9OQU1FJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwYXJhbWV0cmljX25hbWUnLCAnc3RlcCddKVsnaW1wb3J0YW5jZSddLnN1bSgpLnJlc2V0X2luZGV4KCkpDQogICAgICAgIGZlYXR1cmVfaW1wb3J0YW5jZV9ncm91cGJ5ID0gZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnkuYXNzaWduKHBhcmFtZXRyaWNfbmFtZT1sYW1iZGEgeDogeFsncGFyYW1ldHJpY19uYW1lJ10gKyBzdHIoJyMnKSArIHhbJ3N0ZXAnXSkuZHJvcCgnc3RlcCcsIGF4aXM9MSkNCg0KICAgICAgICAjIGZlYXR1cmVfc3RhdHPlkoxmZWF0dXJlX2ltcG9ydGFuY2VfZ3JvdXBieei/nuaOpQ0KICAgICAgICBncnBieV9zdGF0cyA9IHBkLm1lcmdlKGZlYXR1cmVfc3RhdHMsIGZlYXR1cmVfaW1wb3J0YW5jZV9ncm91cGJ5LCBvbj1bJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRScsICdwYXJhbWV0cmljX25hbWUnXSkuZHJvcG5hKCkucmVzZXRfaW5kZXgoZHJvcD1UcnVlKQ0KICAgICAgICByZXR1cm4gZ3JwYnlfc3RhdHMNCiAgICByZXR1cm4gZGYuZ3JvdXBieShieSkuYXBwbHkoZ2V0X3Jlc3VsdCkNCg0KICAgIA0KDQpkZWYgZ2V0X2ZpbmFsbF9yZXN1bHRzX2JpZ19zYW1wbGUoc19yZXMsIGZfcmVzLCBiYWRfd2FmZXJfbnVtKToNCiAgICAiIiINCiAgICBwYXJhbSBzX3Jlczogcm9jX2F1Y+WIhuaVsOe7k+aenA0KICAgIHBhcmFtIGZfcmVzOiBmZWF0dXJlc+WSjGltcG9ydGFuY2Xnu5PmnpwNCiAgICBwYXJhbSBiYWRfd2FmZXJfbnVtOiDmlbDmja7kuK3miYDmnIliYWRfd2FmZXLnmoTmlbDph48NCiAgICByZXR1cm46IOacgOWQjueahOW7uuaooee7k+aenA0KICAgICIiIg0KICAgICMgZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnnlkoxzYW1wbGVfcmVz6L+e5o6lDQogICAgcm9jX2F1Y19zY29yZV9hbGwgPSBzX3Jlcy5hZ2coeyJyb2NfYXVjX3Njb3JlIjogInN1bSJ9KS5jb2xsZWN0KClbMF1bMF0NCiAgICBzX3JlcyA9IHNfcmVzLndpdGhDb2x1bW4oInJvY19hdWNfc2NvcmVfcmF0aW8iLCBjb2woInJvY19hdWNfc2NvcmUiKS9yb2NfYXVjX3Njb3JlX2FsbCkNCiAgICBzX3JlcyA9IHNfcmVzLndpdGhDb2x1bW4oImJhZF9yYXRpbyIsIGNvbCgiYmFkX3dhZmVyIikgLyBiYWRfd2FmZXJfbnVtKQ0KDQogICAgZGZfbWVyZ2UgPSBzX3Jlcy5qb2luKGZfcmVzLCBvbj1bJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRSddLCBob3c9J2xlZnQnKQ0KICAgIGRmX21lcmdlID0gZGZfbWVyZ2Uud2l0aENvbHVtbignd2VpZ2h0X29yaWdpbmFsJywgY29sKCdyb2NfYXVjX3Njb3JlX3JhdGlvJykgKiBjb2woJ2JhZF9yYXRpbycpICogY29sKCdpbXBvcnRhbmNlJykpDQoNCiAgICAjIOacgOWQjuWGjeasoei/m+ihjOS4gOasoeW9kuS4gOWMlg0KICAgIHdlaWdodF9hbGwgPSBkZl9tZXJnZS5hZ2coeyJ3ZWlnaHRfb3JpZ2luYWwiOiAic3VtIn0pLmNvbGxlY3QoKVswXVswXQ0KICAgIGRmX21lcmdlID0gZGZfbWVyZ2Uud2l0aENvbHVtbigid2VpZ2h0IiwgY29sKCJ3ZWlnaHRfb3JpZ2luYWwiKSAvIHdlaWdodF9hbGwpDQoNCiAgICBkZl9tZXJnZSA9IGRmX21lcmdlLnNlbGVjdChbJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwYXJhbWV0cmljX25hbWUnLCAnd2VpZ2h0JywgJ3N0YXRzJ10pLm9yZGVyQnkoJ3dlaWdodCcsIGFzY2VuZGluZz1GYWxzZSkNCiAgICByZXR1cm4gZGZfbWVyZ2UNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+WwhuW7uuaooeWQjueahOe7k+aenOWinuWKoOeJueWumueahOWIlyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KZGVmIGFkZF9jZXJ0YWluX2NvbHVtbihkZiwgYnksIHJlcXVlc3RfaWQpOg0KICAgICIiIg0KICAgIHBhcmFtIGRmOiDmnIDlkI7nmoTlu7rmqKHnu5PmnpwNCiAgICBwYXJhbSBieTog5YiG57uE5a2X5q61LCDmiYvliqjlop7liqDkuIDliJdhZGQNCiAgICBwYXJhbSByZXF1ZXN0X2lkOiDkvKDlhaXnmoRyZXF1ZXN0X2lkDQogICAgcmV0dXJuOiDmnIDlkI7nmoTlu7rmqKHnu5Pmnpzlop7liqDnibnlrprnmoTliJcNCiAgICAiIiINCiAgICBzY2hlbWFfYWxsID0gU3RydWN0VHlwZShbDQogICAgICAgIFN0cnVjdEZpZWxkKCJQUk9ERzEiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgiT1BFUl9OTyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgic3RhdHMiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgicGFyYW1ldHJpY19uYW1lIiwgU3RyaW5nVHlwZSgpLCBUcnVlKSwNCiAgICAgICAgU3RydWN0RmllbGQoIndlaWdodCIsIEZsb2F0VHlwZSgpLCBUcnVlKSwNCiAgICAgICAgU3RydWN0RmllbGQoInJlcXVlc3RfaWQiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICBTdHJ1Y3RGaWVsZCgid2VpZ2h0X3BlcmNlbnQiLCBGbG9hdFR5cGUoKSwgVHJ1ZSksDQogICAgICAgIFN0cnVjdEZpZWxkKCJpbmRleF9ubyIsIEludGVnZXJUeXBlKCksIFRydWUpXSkNCg0KICAgIEBwYW5kYXNfdWRmKHJldHVyblR5cGU9c2NoZW1hX2FsbCwgZnVuY3Rpb25UeXBlPVBhbmRhc1VERlR5cGUuR1JPVVBFRF9NQVApDQogICAgZGVmIGdldF9yZXN1bHQoZmluYWxfcmVzKToNCiAgICAgICAgZmluYWxfcmVzWyd3ZWlnaHQnXSA9IGZpbmFsX3Jlc1snd2VpZ2h0J10uYXN0eXBlKGZsb2F0KQ0KICAgICAgICBmaW5hbF9yZXMgPSBmaW5hbF9yZXMucXVlcnkoIndlaWdodCA+IDAiKQ0KICAgICAgICBmaW5hbF9yZXNbJ3JlcXVlc3RfaWQnXSA9IHJlcXVlc3RfaWQNCiAgICAgICAgZmluYWxfcmVzWyd3ZWlnaHRfcGVyY2VudCddID0gZmluYWxfcmVzWyd3ZWlnaHQnXSAqIDEwMA0KICAgICAgICBmaW5hbF9yZXMgPSBmaW5hbF9yZXMuc29ydF92YWx1ZXMoJ3dlaWdodCcsIGFzY2VuZGluZz1GYWxzZSkNCiAgICAgICAgZmluYWxfcmVzWydpbmRleF9ubyddID0gW2kgKyAxIGZvciBpIGluIHJhbmdlKGxlbihmaW5hbF9yZXMpKV0NCiAgICAgICAgZmluYWxfcmVzID0gZmluYWxfcmVzLmRyb3AoJ2FkZCcsIGF4aXM9MSkNCiAgICAgICAgIyBmaW5hbF9yZXNbJ3BhcmFtZXRyaWNfbmFtZSddID0gZmluYWxfcmVzWydwYXJhbWV0cmljX25hbWUnXS5zdHIucmVwbGFjZSgiXyIsICIrIikNCiAgICAgICAgZmluYWxfcmVzWydQUk9ERzEnXSA9IGZpbmFsX3Jlc1snUFJPREcxJ10uYXBwbHkobGFtYmRhIHg6IE5vbmUgaWYgeCA9PSAnZ3JwbGVuMicgZWxzZSB4KQ0KICAgICAgICByZXR1cm4gZmluYWxfcmVzDQogICAgcmV0dXJuIGRmLmdyb3VwYnkoYnkpLmFwcGx5KGdldF9yZXN1bHQpDQoNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+WwhuacgOWQjueahOe7k+aenOWGmeWbnuaVsOaNruW6kyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCmRlZiBkb3Jpc19zdHJlYW1fbG9hZF9mcm9tX2RmKGRmLCBlbmdpbmUsIHRhYmxlLCBpc19qc29uPVRydWUsIGNodW5rc2l6ZT0xMDAwMDAsIHBhcnRpdGlvbnM9Tm9uZSk6DQogICAgZW5naW5lX3VybCA9IGVuZ2luZS51cmwNCiAgICB1cmwgPSAnaHR0cDovLyVzOjE4MDMwL2FwaS8lcy8lcy9fc3RyZWFtX2xvYWQnICUgKGVuZ2luZV91cmwuaG9zdCwgZW5naW5lX3VybC5kYXRhYmFzZSwgdGFibGUpDQoNCiAgICBmb3JtYXRfc3RyID0gJ2NzdicgaWYgbm90IGlzX2pzb24gZWxzZSAnanNvbicNCiAgICBoZWFkZXJzID0gew0KICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgnLA0KICAgICAgICAnZm9ybWF0JzogZm9ybWF0X3N0ciwNCiAgICAgICAgJ0V4cGVjdCc6ICcxMDAtY29udGludWUnDQogICAgfQ0KICAgIGlmIGlzX2pzb246DQogICAgICAgIGhlYWRlcnNbJ3N0cmlwX291dGVyX2FycmF5J10gPSAndHJ1ZScNCiAgICAgICAgaGVhZGVyc1sncmVhZF9qc29uX2J5X2xpbmUnXSA9ICd0cnVlJw0KICAgIGVsc2U6DQogICAgICAgIGhlYWRlcnNbJ2NvbHVtbl9zZXBhcmF0b3InXSA9ICdAJw0KICAgIA0KICAgIGlmIHBhcnRpdGlvbnM6DQogICAgICAgIGhlYWRlcnNbJ3BhcnRpdGlvbnMnXSA9IHBhcnRpdGlvbnMNCiAgICANCiAgICBhdXRoID0gcmVxdWVzdHMuYXV0aC5IVFRQQmFzaWNBdXRoKGVuZ2luZV91cmwudXNlcm5hbWUsIGVuZ2luZV91cmwucGFzc3dvcmQpDQogICAgc2Vzc2lvbiA9IHJlcXVlc3RzLnNlc3Npb25zLlNlc3Npb24oKQ0KICAgIHNlc3Npb24uc2hvdWxkX3N0cmlwX2F1dGggPSBsYW1iZGEgb2xkX3VybCwgbmV3X3VybDogRmFsc2UNCiAgICANCiAgICBsID0gbGVuKGRmKQ0KICAgIGlmIGwgPiAwOg0KICAgICAgICBpZiBjaHVua3NpemUgYW5kIGNodW5rc2l6ZSA8IGw6DQogICAgICAgICAgICBiYXRjaGVzID0gbCAvLyBjaHVua3NpemUNCiAgICAgICAgICAgIGlmIGwgJSBjaHVua3NpemUgPiAwOg0KICAgICAgICAgICAgICAgIGJhdGNoZXMgKz0gMQ0KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoYmF0Y2hlcyk6DQogICAgICAgICAgICAgICAgc2kgPSBpICogY2h1bmtzaXplDQogICAgICAgICAgICAgICAgZWkgPSBtaW4oc2kgKyBjaHVua3NpemUsIGwpDQogICAgICAgICAgICAgICAgc3ViID0gZGZbc2k6ZWldDQogICAgICAgICAgICAgICAgZG9fZG9yaXNfc3RyZWFtX2xvYWRfZnJvbV9kZihzdWIsIHNlc3Npb24sIHVybCwgaGVhZGVycywgYXV0aCwgaXNfanNvbikNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGRvX2RvcmlzX3N0cmVhbV9sb2FkX2Zyb21fZGYoZGYsIHNlc3Npb24sIHVybCwgaGVhZGVycywgYXV0aCwgaXNfanNvbikNCg0KDQpkZWYgZG9fZG9yaXNfc3RyZWFtX2xvYWRfZnJvbV9kZihkZiwgc2Vzc2lvbiwgdXJsLCBoZWFkZXJzLCBhdXRoLCBpc19qc29uPUZhbHNlKToNCiAgICBkYXRhID0gZGYudG9fY3N2KGhlYWRlcj1GYWxzZSwgaW5kZXg9RmFsc2UsIHNlcD0nQCcpIGlmIG5vdCBpc19qc29uIGVsc2UgZGYudG9fanNvbihvcmllbnQ9J3JlY29yZHMnLCBkYXRlX2Zvcm1hdD0naXNvJykNCiAgICAjcHJpbnQoZGF0YSkNCiAgICANCiAgICByZXNwID0gc2Vzc2lvbi5yZXF1ZXN0KA0KICAgICAgICAnUFVUJywNCiAgICAgICAgdXJsID0gdXJsLA0KICAgICAgICBkYXRhPWRhdGEuZW5jb2RlKCd1dGYtOCcpLA0KICAgICAgICBoZWFkZXJzPWhlYWRlcnMsDQogICAgICAgIGF1dGg9YXV0aA0KICAgICkNCiAgICBwcmludChyZXNwLnJlYXNvbiwgcmVzcC50ZXh0KQ0KICAgIGNoZWNrX3N0cmVhbV9sb2FkX3Jlc3BvbnNlKHJlc3AudGV4dCkNCg0KDQpkZWYgY2hlY2tfc3RyZWFtX2xvYWRfcmVzcG9uc2UocmVzcF90ZXh0KToNCiAgICByZXNwID0ganNvbi5sb2FkcyhyZXNwX3RleHQpDQogICAgaWYgcmVzcFsnU3RhdHVzJ10gbm90IGluIFsiU3VjY2VzcyIsICJQdWJsaXNoIFRpbWVvdXQiXToNCiAgICAgICAgcmFpc2UgRXhjZXB0aW9uKHJlc3BbJ01lc3NhZ2UnXSkNCg0KDQojIOWkp+agt+acrOaVsOaNruaooeWei+aVtOWQiA0KZGVmIGZpdF9iaWdfZGF0YV9tb2RlbChkZl9ydW4sIGRhdGFfZGljdF9saXN0X2JzLCBncnBieV9saXN0LCByZXF1ZXN0X2lkKToNCg0KICAgIGRmMSA9IE5vbmUNCiAgICBkZjIgPSBOb25lDQogICAgDQogICAgIyAxLiDojrflj5bnlKjkuo7lu7rmqKHnmoTlpKfmoLfmnKzmlbDmja4NCiAgICBkZl9ydW5fYnMgPSBnZXRfdHJhaW5fZGF0YShkZl9ydW4sIGRhdGFfZGljdF9saXN0X2JzKQ0KICAgIGlmIGRmX3J1bl9icy5jb3VudCgpID09IDA6DQogICAgICAgIG1zZyA9ICfmlbDmja7lupPkuK3mmoLml6DmraTnsbvmlbDmja4hJw0KICAgICAgICBkZl9rYWZrYSA9IHBkLkRhdGFGcmFtZSh7ImNvZGUiOiAxLCAibXNnIjogZid7bXNnfScsICJyZXF1ZXN0SWQiOiByZXF1ZXN0X2lkfSwgaW5kZXg9WzBdKQ0KICAgICAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQogICAgICAgIHJldHVybiBkZjEsIGRmMg0KDQogICAgIyAyLiDojrflj5bmiYDmnIliYWQgd2FmZXLmlbDph48NCiAgICBiYWRfd2FmZXJfbnVtX2JpZ19zYW1wbGUgPSBnZXRfYWxsX2JhZF93YWZlcl9udW0oZGZfcnVuX2JzKQ0KICAgIGlmIGJhZF93YWZlcl9udW1fYmlnX3NhbXBsZSA8IDM6DQogICAgICAgIG1zZyA9ICfmlbDmja7lupPkuK3lrp7pmYVCQURfV0FGRVLmlbDph4/lsI/kuo4z54mHLCDor7fmj5Dkvpvmm7TlpJrnmoRCQURfV0FGRVLmlbDph48hJw0KICAgICAgICBkZl9rYWZrYSA9IHBkLkRhdGFGcmFtZSh7ImNvZGUiOiAxLCAibXNnIjogZid7bXNnfScsICJyZXF1ZXN0SWQiOiByZXF1ZXN0X2lkfSwgaW5kZXg9WzBdKQ0KICAgICAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQogICAgICAgIHJldHVybiBkZjEsIGRmMg0KDQoNCiAgICAjIDMuIOWvueaMkemAieWHuueahOWkp+agt+acrOaVsOaNrui/m+ihjOW7uuaooQ0KICAgIHJlcyA9IGZpdF9yZl9iaWdfc2FtcGxlKGRmPWRmX3J1bl9icywgYnk9Z3JwYnlfbGlzdCkNCiAgICBpZiByZXMuY291bnQoKSA9PSAwOg0KICAgICAgICBtc2cgPSAn566X5rOV5YaF6YOo5pqC5pe25byC5bi4IScNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByZXR1cm4gZGYxLCBkZjINCg0KDQogICAgIyA0LiDlsIblu7rmqKHnu5Pmnpzov5vooYzmlbTlkIgNCiAgICBzX3JlcyA9IHNwbGl0X3Njb3JlX2JpZ19zYW1wbGUoZGY9cmVzLCBieT1bJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRSddKQ0KICAgIGlmIHNfcmVzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+eul+azlei/kOihjOivhOWIhue7k+aenOi+g+S9jiwg5pqC5peg6L6T5Ye6LCDlu7rorq7lop7liqBCQURfV0FGRVLmlbDph48nDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmV0dXJuIGRmMSwgZGYyDQoNCiAgICBmX3JlcyA9IHNwbGl0X2NhbGN1bGF0ZV9mZWF0dXJlc19iaWdfc2FtcGxlKGRmPXJlcywgYnk9Z3JwYnlfbGlzdCkNCiAgICBpZiBmX3Jlcy5jb3VudCgpID09IDA6DQogICAgICAgIG1zZyA9ICfnrpfms5Xnu5PmnpzmsYLlkozmmoLml7blvILluLgnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmV0dXJuIGRmMSwgZGYyDQoNCg0KICAgIG1vZGVsX3Jlc19icyA9IGdldF9maW5hbGxfcmVzdWx0c19iaWdfc2FtcGxlKHNfcmVzPXNfcmVzLCBmX3Jlcz1mX3JlcywgYmFkX3dhZmVyX251bT1iYWRfd2FmZXJfbnVtX2JpZ19zYW1wbGUpDQogICAgaWYgbW9kZWxfcmVzX2JzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+eul+azlee7k+aenOaLvOaOpeaaguaXtuW8guW4uCcNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByZXR1cm4gZGYxLCBkZjINCg0KICAgICMgNy4g5aKe5Yqg54m55a6a55qE5YiXDQogICAgZmluYWxfcmVzX2JzID0gbW9kZWxfcmVzX2JzLndpdGhDb2x1bW4oJ2FkZCcsIGxpdCgwKSkNCiAgICBmaW5hbF9yZXNfYWRkX2NvbHVtbnMgPSBhZGRfY2VydGFpbl9jb2x1bW4oZGY9ZmluYWxfcmVzX2JzLCBieT0nYWRkJywgcmVxdWVzdF9pZD1yZXF1ZXN0X2lkKQ0KICAgIGlmIGZpbmFsX3Jlc19hZGRfY29sdW1ucy5jb3VudCgpID09IDA6DQogICAgICAgIG1zZyA9ICfnrpfms5Xnu5Pmnpzlop7liqDliJfmmoLml7blvILluLgnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmV0dXJuIGRmMSwgZGYyDQogICAgZWxzZTogIA0KICAgICAgICByZXR1cm4gZGYxLCBmaW5hbF9yZXNfYWRkX2NvbHVtbnMNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI+WvuWJhZD49MeeahOaVsOaNru+8jOeUqHBjYeW7uuaooSMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQpkZWYgZml0X3BjYV9zbWFsbF9zYW1wbGUoZGYsIGJ5KToNCiAgICAiIiINCiAgICBwYXJhbSBkZjog5bCP5qC35pys57uE5ZCI55qE5pWw5o2uDQogICAgcGFyYW0gYnk6IOWIhue7hOWtl+autQ0KICAgIHJldHVybjogUENB5bu65qih5ZCO55qE57uT5p6cDQogICAgIiIiDQogICAgc2NoZW1hX2FsbCA9IFN0cnVjdFR5cGUoW1N0cnVjdEZpZWxkKCJQUk9ERzEiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiT1BFUl9OTyIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiZmVhdHVyZXMiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiaW1wb3J0YW5jZSIsIEZsb2F0VHlwZSgpLCBUcnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RydWN0RmllbGQoImJhZF93YWZlciIsIEludGVnZXJUeXBlKCksIFRydWUpXSkgDQoNCiAgICBAcGFuZGFzX3VkZihyZXR1cm5UeXBlPXNjaGVtYV9hbGwsIGZ1bmN0aW9uVHlwZT1QYW5kYXNVREZUeXBlLkdST1VQRURfTUFQKQ0KICAgIGRlZiBnZXRfbW9kZWxfcmVzdWx0KGRmX3J1bik6DQogICAgICAgIGRmX3Bpdm90ID0gZ2V0X3Bpdm90X3RhYmxlKGRmPWRmX3J1biwgYnk9YnkpDQogICAgICAgICMg55Sx5LqO5piv5bCP5qC35pys77yM5YaN6YeN5pawY29weeS4gOS7veWItumAoOWkmuS4gOeCueaVsOaNruS8oOe7mVBDQeaooeWeiw0KICAgICAgICBkZl9waXZvdF9jb3B5ID0gZGZfcGl2b3QuY29weSgpDQogICAgICAgIGRmX3Bpdm90X2FsbCA9IHBkLmNvbmNhdChbZGZfcGl2b3QsIGRmX3Bpdm90X2NvcHldLCBheGlzPTApDQoNCiAgICAgICAgIyDlrprkuYnoh6rlj5jph48NCiAgICAgICAgeF90cmFpbiA9IGRmX3Bpdm90X2FsbFtkZl9waXZvdF9hbGwuY29sdW1ucy5kaWZmZXJlbmNlKFsnV0FGRVJfSUQnLCAnbGFiZWwnXSkudG9saXN0KCldDQoNCiAgICAgICAgIyDlu7rnq4vmqKHlnovvvIzkvKDlhaXnu5lQQ0HnmoRuX2NvbXBvbmVudHPpgInmi6l4X3RyYWluLnNoYXBl5Lit55qE5pyA5bCP5YC8LTHvvJsNCiAgICAgICAgIyDpgInmi6nmmK83MCXmiJbogIU4MCXvvIzlh7rmnaXnmoTnibnlvoHlvojmnInlj6/og73lj6rmmK/kuIDkuKTkuKoNCiAgICAgICAgbW9kZWwgPSBwY2Eobl9jb21wb25lbnRzPW1pbih4X3RyYWluLnNoYXBlWzBdLCB4X3RyYWluLnNoYXBlWzFdKS0xLCB2ZXJib3NlPU5vbmUpDQogICAgICAgIHJlc3VsdHMgPSBtb2RlbC5maXRfdHJhbnNmb3JtKHhfdHJhaW4pDQogICAgICAgIHJlc190b3AgPSByZXN1bHRzWyd0b3BmZWF0J10NCiAgICAgICAgcmVzX3RvcF9zZWxlY3QgPSByZXNfdG9wW3Jlc190b3BbJ3R5cGUnXSA9PSAnYmVzdCddW1snZmVhdHVyZScsICdsb2FkaW5nJ11dDQogICAgICAgIHJlc190b3Bfc2VsZWN0ID0gcmVzX3RvcF9zZWxlY3QuZHJvcF9kdXBsaWNhdGVzKCkNCiAgICAgICAgcmVzX3RvcF9zZWxlY3RbJ2ltcG9ydGFuY2UnXSA9IGFicyhyZXNfdG9wX3NlbGVjdFsnbG9hZGluZyddKQ0KICAgICAgICByZXNfdG9wX3NlbGVjdCA9IHJlc190b3Bfc2VsZWN0LnJlbmFtZShjb2x1bW5zPXsnZmVhdHVyZSc6ICdmZWF0dXJlcyd9KQ0KICAgICAgICByZXNfdG9wX3NlbGVjdCA9IHJlc190b3Bfc2VsZWN0LmRyb3AoImxvYWRpbmciLCBheGlzPTEpDQogICAgICAgIA0KICAgICAgICAjIOWinuWKoOS4gOS6m+Wtl+auteS/oeaBrw0KICAgICAgICByZXNfdG9wX3NlbGVjdFsnYmFkX3dhZmVyJ10gPSBzdW0oZGZfcGl2b3RbJ2xhYmVsJ10pDQogICAgICAgIHJlc190b3Bfc2VsZWN0WydPUEVSX05PJ10gPSBkZl9ydW5bJ09QRVJfTk8nXS52YWx1ZXNbMF0NCiAgICAgICAgcmVzX3RvcF9zZWxlY3RbJ1RPT0xfTkFNRSddID0gZGZfcnVuWydUT09MX05BTUUnXS52YWx1ZXNbMF0NCiAgICAgICAgaWYgbGVuKGJ5KSA9PSAzOiANCiAgICAgICAgICAgIHJlc190b3Bfc2VsZWN0WydQUk9ERzEnXSA9IGRmX3J1blsnUFJPREcxJ10udmFsdWVzWzBdDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICByZXNfdG9wX3NlbGVjdFsnUFJPREcxJ10gPSAnZ3JwbGVuMicNCg0KICAgICAgICByZXR1cm4gcmVzX3RvcF9zZWxlY3QNCiAgICByZXR1cm4gZGYuZ3JvdXBieShieSkuYXBwbHkoZ2V0X21vZGVsX3Jlc3VsdCkNCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj5a+5YmFkPj0x5bu65qih5ZCO55qE57uT5p6c6L+b6KGM5pW05ZCIIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KZGVmIHNwbGl0X2NhbGN1bGF0ZV9mZWF0dXJlc19zbWFsbF9zYW1wbGUoZGYsIGJ5KToNCiAgICAiIiINCiAgICBwYXJhbSBkZjogUENB5bu65qih5ZCO55qE57uT5p6cDQogICAgcGFyYW0gYnk6IOWIhue7hOWtl+autQ0KICAgIHJldHVybjogZmVhdHVyZXPlkoxpbXBvcnRhbmNl57uT5p6cDQogICAgIiIiDQogICAgc2NoZW1hX2FsbCA9IFN0cnVjdFR5cGUoWyBTdHJ1Y3RGaWVsZCgiUFJPREcxIiwgU3RyaW5nVHlwZSgpLCBUcnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJPUEVSX05PIiwgU3RyaW5nVHlwZSgpLCBUcnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJUT09MX05BTUUiLCBTdHJpbmdUeXBlKCksIFRydWUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RydWN0RmllbGQoInBhcmFtZXRyaWNfbmFtZSIsIFN0cmluZ1R5cGUoKSwgVHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgiaW1wb3J0YW5jZSIsIEZsb2F0VHlwZSgpLCBUcnVlKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cnVjdEZpZWxkKCJiYWRfd2FmZXIiLCBGbG9hdFR5cGUoKSwgVHJ1ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJ1Y3RGaWVsZCgic3RhdHMiLCBTdHJpbmdUeXBlKCksIFRydWUpXSkgDQoNCiAgICBAcGFuZGFzX3VkZihyZXR1cm5UeXBlPXNjaGVtYV9hbGwsIGZ1bmN0aW9uVHlwZT1QYW5kYXNVREZUeXBlLkdST1VQRURfTUFQKQ0KICAgIGRlZiBnZXRfcmVzdWx0KG1vZGVsX3Jlc3VsdHMpOiAgICAgICAgDQogICAgICAgIGZlYXR1cmVfaW1wb3J0YW5jZV90YWJsZSA9IG1vZGVsX3Jlc3VsdHNbWydmZWF0dXJlcycsICAnaW1wb3J0YW5jZScsICdiYWRfd2FmZXInXV0uZHJvcG5hKGF4aXM9MCkNCiAgICAgICAgIyDliIboo4JmZWF0dXJlcw0KICAgICAgICBmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0ID0gZ2V0X3NwbGl0X2ZlYXR1cmVfaW1wb3J0YW5jZV90YWJsZShmZWF0dXJlX2ltcG9ydGFuY2VfdGFibGUsIGJ5KQ0KDQogICAgICAgICMg5paw5aKe5LiA5YiX77yM5ZCr5pyJ5Y+C5pWw55qE5omA5pyJ57uf6K6h54m55b6BOmZlYXR1cmVfc3RhdHMNCiAgICAgICAgZmVhdHVyZV9zdGF0cyA9IGFkZF9mZWF0dXJlX3N0YXRzKGZlYXR1cmVfaW1wb3J0YW5jZV9yZXNfc3BsaXQpDQoNCiAgICAgICAgI+WvueWQjOS4gOenjee7hOWQiOmHjOeahOWQjOS4gOS4quWPguaVsOi/m+ihjOaxguWSjDpmZWF0dXJlX2ltcG9ydGFuY2VfZ3JvdXBieQ0KICAgICAgICBmZWF0dXJlX2ltcG9ydGFuY2VfZ3JvdXBieSA9IChmZWF0dXJlX2ltcG9ydGFuY2VfcmVzX3NwbGl0Lmdyb3VwYnkoWydQUk9ERzEnLCAnT1BFUl9OTycsICdUT09MX05BTUUnLCAnYmFkX3dhZmVyJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncGFyYW1ldHJpY19uYW1lJywnc3RlcCddKVsnaW1wb3J0YW5jZSddLnN1bSgpLnJlc2V0X2luZGV4KCkpDQogICAgICAgIGZlYXR1cmVfaW1wb3J0YW5jZV9ncm91cGJ5ID0gZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnkuYXNzaWduKHBhcmFtZXRyaWNfbmFtZT1sYW1iZGEgeDogeFsncGFyYW1ldHJpY19uYW1lJ10rc3RyKCcjJykreFsnc3RlcCddKS5kcm9wKCdzdGVwJywgYXhpcz0xKQ0KDQogICAgICAgICMgZmVhdHVyZV9zdGF0c+WSjGZlYXR1cmVfaW1wb3J0YW5jZV9ncm91cGJ56L+e5o6lDQogICAgICAgIGdycGJ5X3N0YXRzID0gcGQubWVyZ2UoZmVhdHVyZV9zdGF0cywgZmVhdHVyZV9pbXBvcnRhbmNlX2dyb3VwYnksIG9uPVsnUFJPREcxJywgJ09QRVJfTk8nLCAnVE9PTF9OQU1FJywgJ3BhcmFtZXRyaWNfbmFtZSddKS5kcm9wbmEoKS5yZXNldF9pbmRleChkcm9wPVRydWUpDQogICAgICAgIHJldHVybiBncnBieV9zdGF0cw0KICAgIHJldHVybiBkZi5ncm91cGJ5KGJ5KS5hcHBseShnZXRfcmVzdWx0KQ0KDQoNCmRlZiBnZXRfZmluYWxsX3Jlc3VsdHNfc21hbGxfc2FtcGxlKGZfcmVzLCBiYWRfd2FmZXJfbnVtKToNCiAgICAiIiINCiAgICBwYXJhbSBzX3Jlczogcm9jX2F1Y+WIhuaVsOe7k+aenA0KICAgIHBhcmFtIGZfcmVzOiBmZWF0dXJlc+WSjGltcG9ydGFuY2Xnu5PmnpwNCiAgICBwYXJhbSBiYWRfd2FmZXJfbnVtOiDmlbDmja7kuK3miYDmnIliYWRfd2FmZXLnmoTmlbDph48NCiAgICByZXR1cm46IOacgOWQjueahOW7uuaooee7k+aenA0KICAgICIiIg0KICAgIGZfcmVzID0gZl9yZXMud2l0aENvbHVtbigiYmFkX3JhdGlvIiwgY29sKCJiYWRfd2FmZXIiKSAvIGJhZF93YWZlcl9udW0pDQogICAgZGZfbWVyZ2UgPSBmX3Jlcy53aXRoQ29sdW1uKCd3ZWlnaHRfb3JpZ2luYWwnLCBjb2woJ2ltcG9ydGFuY2UnKSAqIGNvbCgnYmFkX3JhdGlvJykpDQoNCiAgICAjIOacgOWQjuWGjeasoei/m+ihjOS4gOasoeW9kuS4gOWMlg0KICAgIHdlaWdodF9hbGwgPSBkZl9tZXJnZS5hZ2coeyJ3ZWlnaHRfb3JpZ2luYWwiOiAic3VtIn0pLmNvbGxlY3QoKVswXVswXQ0KICAgIGRmX21lcmdlID0gZGZfbWVyZ2Uud2l0aENvbHVtbigid2VpZ2h0IiwgY29sKCJ3ZWlnaHRfb3JpZ2luYWwiKSAvIHdlaWdodF9hbGwpDQoNCiAgICBkZl9tZXJnZSA9IGRmX21lcmdlLnNlbGVjdChbJ1BST0RHMScsICdPUEVSX05PJywgJ1RPT0xfTkFNRScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwYXJhbWV0cmljX25hbWUnLCAnd2VpZ2h0JywgJ3N0YXRzJ10pLm9yZGVyQnkoJ3dlaWdodCcsIGFzY2VuZGluZz1GYWxzZSkNCiAgICByZXR1cm4gZGZfbWVyZ2UNCg0KDQojIOWwj+agt+acrOaVsOaNruaooeWei+aVtOWQiA0KZGVmIGZpdF9zbWFsbF9kYXRhX21vZGVsKGRmX3J1biwgY29tbW9uX3JlcywgZ3JwYnlfbGlzdCwgcmVxdWVzdF9pZCk6DQogICAgDQogICAgZGYxID0gTm9uZQ0KICAgIGRmMiA9IE5vbmUNCg0KICAgIGRhdGFfZGljdF9saXN0X3NzID0gZ2V0X2RhdGFfbGlzdChjb21tb25fcmVzPWNvbW1vbl9yZXMsIGdycGJ5X2xpc3Q9Z3JwYnlfbGlzdCwgYmlnX29yX3NtYWxsPSdzbWFsbCcpDQogICAgcHJpbnQoImRhdGFfZGljdF9saXN0X3NzOiIsIGRhdGFfZGljdF9saXN0X3NzKQ0KICAgIGlmIGxlbihkYXRhX2RpY3RfbGlzdF9zcykgPT0gMDoNCiAgICAgICAgbXNnID0gJ+ivpeafpeivouadoeS7tuS4i+aVsOaNruW6k+S4reWunumZhUJBRF9XQUZFUuaVsOmHj+S4ujAsIOaXoOazleWIhuaekCcNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByZXR1cm4gZGYxLCBkZjINCg0KICAgIGRmX3J1bl9zcyA9IGdldF90cmFpbl9kYXRhKGRmX3J1bj1kZl9ydW4sIGRhdGFfZGljdF9saXN0PWRhdGFfZGljdF9saXN0X3NzKQ0KICAgIGlmIGRmX3J1bl9zcy5jb3VudCgpID09IDA6DQogICAgICAgIG1zZyA9ICfmlbDmja7lupPkuK3mmoLml6DmraTnsbvmlbDmja4hJw0KICAgICAgICBkZl9rYWZrYSA9IHBkLkRhdGFGcmFtZSh7ImNvZGUiOiAxLCAibXNnIjogZid7bXNnfScsICJyZXF1ZXN0SWQiOiByZXF1ZXN0X2lkfSwgaW5kZXg9WzBdKQ0KICAgICAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQogICAgICAgIHJldHVybiBkZjEsIGRmMg0KDQogICAgYmFkX3dhZmVyX251bV9zbWFsbF9zYW1wbGUgPSBnZXRfYWxsX2JhZF93YWZlcl9udW0oZGZfcnVuX3NzKQ0KICAgIGlmIGJhZF93YWZlcl9udW1fc21hbGxfc2FtcGxlIDwgMToNCiAgICAgICAgbXNnID0gJ+ivpeafpeivouadoeS7tuS4i+aVsOaNruW6k+S4reWunumZhUJBRF9XQUZFUuaVsOmHj+Wwj+S6jjHniYcsIOivt+aPkOS+m+abtOWkmueahEJBRF9XQUZFUuaVsOmHjyEnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmV0dXJuIGRmMSwgZGYyDQoNCiAgICByZXMgPSBmaXRfcGNhX3NtYWxsX3NhbXBsZShkZj1kZl9ydW5fc3MsIGJ5PWdycGJ5X2xpc3QpDQogICAgaWYgcmVzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+eul+azleWGhemDqOaaguaXtuW8guW4uCEnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmV0dXJuIGRmMSwgZGYyDQoNCiAgICBmX3JlcyA9IHNwbGl0X2NhbGN1bGF0ZV9mZWF0dXJlc19zbWFsbF9zYW1wbGUoZGY9cmVzLCBieT1ncnBieV9saXN0KQ0KICAgIGlmIGZfcmVzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+eul+azlee7k+aenOaxguWSjOaaguaXtuW8guW4uCcNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByZXR1cm4gZGYxLCBkZjINCg0KICAgIG1vZGVsX3Jlc19zcyA9IGdldF9maW5hbGxfcmVzdWx0c19zbWFsbF9zYW1wbGUoZl9yZXM9Zl9yZXMsIGJhZF93YWZlcl9udW09YmFkX3dhZmVyX251bV9zbWFsbF9zYW1wbGUpDQogICAgaWYgbW9kZWxfcmVzX3NzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+eul+azlee7k+aenOaLvOaOpeaaguaXtuW8guW4uCcNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByZXR1cm4gZGYxLCBkZjINCg0KICAgIGZpbmFsX3Jlc19zcyA9IG1vZGVsX3Jlc19zcy53aXRoQ29sdW1uKCdhZGQnLCBsaXQoMCkpDQogICAgZmluYWxfcmVzX2FkZF9jb2x1bW5zID0gYWRkX2NlcnRhaW5fY29sdW1uKGRmPWZpbmFsX3Jlc19zcywgYnk9J2FkZCcsIHJlcXVlc3RfaWQ9cmVxdWVzdF9pZCkNCiAgICBpZiBmaW5hbF9yZXNfYWRkX2NvbHVtbnMuY291bnQoKSA9PSAwOg0KICAgICAgICBtc2cgPSAn566X5rOV57uT5p6c5aKe5Yqg5YiX5pqC5pe25byC5bi4Jw0KICAgICAgICBkZl9rYWZrYSA9IHBkLkRhdGFGcmFtZSh7ImNvZGUiOiAxLCAibXNnIjogZid7bXNnfScsICJyZXF1ZXN0SWQiOiByZXF1ZXN0X2lkfSwgaW5kZXg9WzBdKQ0KICAgICAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQogICAgICAgIHJldHVybiBkZjEsIGRmMg0KICAgIGVsc2U6DQogICAgICAgIHJldHVybiBkZjEsIGZpbmFsX3Jlc19hZGRfY29sdW1ucw0KDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyPmraPlvI/osIPnlKjku6XkuIrlh73mlbAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyByZXF1ZXN0X2lkID0gJ3NkZCcNCiMgZ3JwYnlfbGlzdCA9IFsnT1BFUl9OTycsICdUT09MX05BTUUnXQ0KDQojIDEuIOino+aekGpzb24g5Li65a2X5YW477yMIGRmMeS4umthZmth6L6T5YWl55qE57uT5p6c5pWw5o2u77yM6I635Y+W5YiwcGFyc2VfZGljdCwgcmVxdWVzdF9pZCwgZ3JwYnlfbGlzdCwgbWVyZ2Vfb3Blcm5vDQpkZjIgPSBkZjEudG9QYW5kYXMoKSANCnBhcnNlX2RpY3QsIHJlcXVlc3RfaWQsIGdycGJ5X2xpc3QsIG1lcmdlX29wZXJubyA9IGdldF9zb21lX2luZm8oZGYyKQ0KIyBwcmludCgicGFyc2VfZGljdOaYr++8miIsIHBhcnNlX2RpY3QpDQojIHByaW50KCJwYXJzZV9kaWN055qE57G75Z6L5piv77yaIiwgdHlwZShwYXJzZV9kaWN0KSkNCiMgcHJpbnQoInJlcXVlc3RfaWTmmK/vvJoiLCByZXF1ZXN0X2lkKQ0KIyBwcmludCgiZ3JwYnlfbGlzdOaYr++8miIsIGdycGJ5X2xpc3QpDQojIHByaW50KCJtZXJnZV9vcGVybm/mmK/vvJoiLCBtZXJnZV9vcGVybm8pDQoNCiMgMi4g5LuOa2Fma2Eg5YWz6ZSu5a2X5pig5bCE6YO95YW35L2T5pWw5o2u5rqQ5Lit55qE5a2X5q61LOayoeacieeahOWPr+S7peWIoOmZpA0Ka2V5d29yZF9tYXBfZnJvbV9qc29uX3RvX3RhYmxlOiBkaWN0ID0gew0KICAgICJwcm9kZzEiOiAiUFJPREcxIiwNCiAgICAid2FmZXJJZCI6ICJXQUZFUl9JRCIsDQogICAgImRhdGVSYW5nZSI6ICJTVEFSVF9USU1FIiwNCiAgICAicHJvZHVjdElkIjogIlBST0RVQ1RfSUQiLA0KICAgICJvcGVyTm8iOiAiT1BFUl9OTyIsDQogICAgImVxcCI6ICJFUVBfTkFNRSIsDQogICAgInRvb2wiOiAiVE9PTF9OQU1FIiwNCiAgICAibG90IjogIkxPVF9JRCIsDQogICAgInJlY2lwZU5hbWUiOiAiUkVDSVBFX05BTUUifQ0KDQojIDMuIOiOt+WPluafpeivouadoeS7tmxpc3QNCnNlbGVjdF9jb25kaXRpb25fbGlzdCA9IHBhcnNlX2RpY3QNCg0KIyA0LiDmjIflrprmn6Xor6LooajlkI0sIOagueaNruWunumZheaDheWGtemcgOimgeS/ruaUuQ0KdGFibGVfbmFtZSA9ICJldGwuRFdEX1BPQ19DQVNFX0ZEX1VWQV9EQVRBX1RFU1QiDQoNCiMg5Li756iL5bqPDQp0cnk6DQogICAgIyDku47mlbDmja7lupPkuK3ojrflj5bmlbDmja4NCiAgICBkZjEgPSBnZXRfZGF0YV9mcm9tX2RvcmlzKHNlbGVjdF9jb25kaXRpb25fbGlzdD1zZWxlY3RfY29uZGl0aW9uX2xpc3QsIHRhYmxlX25hbWU9dGFibGVfbmFtZSkNCiAgICAjIHByaW50KGRmMS5jb3VudCgpKQ0KICAgIGlmIGRmMS5jb3VudCgpID09IDA6DQogICAgICAgIG1zZyA9ICfop6PmnpBTUUzojrflj5bmlbDmja7lvILluLg6IOaVsOaNruW6k+S4reWPr+iDveayoeacieaVsOaNriEnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcg0KDQogICAgIyAxLiDnq5nngrnono3lkIjlkozmlbDmja7pooTlpITnkIYNCiAgICBkZjEgPSBpbnRlZ3JhdGVfb3Blcm5vKGRmPWRmMSwgbWVyZ2Vfb3Blcm5vX2xpc3Q9bWVyZ2Vfb3Blcm5vKQ0KICAgIGRmX3J1biA9IF9wcmVfcHJvY2VzcyhkZjEpDQogICAgaWYgZGZfcnVuLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+ivpeadoeS7tuS4i+aVsOaNruW6k+S4reaaguaXoOaVsOaNru+8jOivt+ajgOafpe+8gScNCiAgICAgICAgZGZfa2Fma2EgPSBwZC5EYXRhRnJhbWUoeyJjb2RlIjogMSwgIm1zZyI6IGYne21zZ30nLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICAgICAgZGYxID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRmX2thZmthKQ0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yDQoNCiAgICAjIDIuIOi/m+ihjOWFseaAp+WIhuaekA0KICAgIGNvbW1vbl9yZXMgPSBjb21tb25hbGl0eV9hbmFseXNpcyhkZl9ydW4sIGdycGJ5X2xpc3QpDQogICAgY29tbW9uX3Jlcy5zaG93KCkNCiAgICBpZiBjb21tb25fcmVzLmNvdW50KCkgPT0gMDoNCiAgICAgICAgbXNnID0gJ+WFseaAp+WIhuaekOe7k+aenOW8guW4uCEnDQogICAgICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmJ3ttc2d9JywgInJlcXVlc3RJZCI6IHJlcXVlc3RfaWR9LCBpbmRleD1bMF0pDQogICAgICAgIGRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkZl9rYWZrYSkNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcg0KDQogICAgIyAzLiDmjJHpgInlh7rmlbDmja7vvJpiYWTlkoxnb29k6KaB5ZCM5pe25aSn5LqOMw0KICAgIGRhdGFfZGljdF9saXN0X2JzID0gZ2V0X2RhdGFfbGlzdChjb21tb25fcmVzLCBncnBieV9saXN0LCBiaWdfb3Jfc21hbGw9J2JpZycpDQogICAgcHJpbnQoImRhdGFfZGljdF9saXN0X2JzOiIsIGRhdGFfZGljdF9saXN0X2JzKQ0KICAgIGlmIGxlbihkYXRhX2RpY3RfbGlzdF9icykgIT0gMDoNCiAgICAgICAgcHJpbnQoIioqKioqKioqKioqKioqKirlpKfmoLfmnKznrpfms5XosIPnlKgqKioqKioqKioqKioqKioqIikNCiAgICAgICAgZGYxLCBmaW5hbF9yZXNfYWRkX2NvbHVtbnMgPSBmaXRfYmlnX2RhdGFfbW9kZWwoZGZfcnVuLCBkYXRhX2RpY3RfbGlzdF9icywgZ3JwYnlfbGlzdCwgcmVxdWVzdF9pZCkNCiAgICBlbHNlOiAgICAgICAgDQogICAgICAgIHByaW50KCIqKioqKioqKioqKioqKioq5bCP5qC35pys566X5rOV6LCD55SoKioqKioqKioqKioqKioqKiIpDQogICAgICAgIGRmMSwgZmluYWxfcmVzX2FkZF9jb2x1bW5zID0gZml0X3NtYWxsX2RhdGFfbW9kZWwoZGZfcnVuLCBjb21tb25fcmVzLCBncnBieV9saXN0LCByZXF1ZXN0X2lkKQ0KICAgIA0KDQogICAgaWYgZGYxIGlzIG5vdCBOb25lOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yDQogICAgZWxzZToNCiAgICAgICAgIyBmaW5hbF9yZXNfYWRkX2NvbHVtbnMg5piv5pyA5ZCO55qE57uT5p6c77yM6KaB5YaZ5Zue5pWw5o2u5bqTDQogICAgICAgIGRkZCA9IGZpbmFsX3Jlc19hZGRfY29sdW1ucy50b1BhbmRhcygpDQogICAgICAgIHVzZXIgPSJyb290Ig0KICAgICAgICBob3N0ID0gIjEwLjUyLjE5OS44MSINCiAgICAgICAgcGFzc3dvcmQgPSAiTmV4Y2hpcCU0MDEyMyINCiAgICAgICAgZGIgPSAiZXRsIg0KICAgICAgICBwb3J0ID0gOTAzMA0KICAgICAgICBlbmdpbmUgPSBjcmVhdGVfZW5naW5lKCJteXNxbCtweW15c3FsOi8ve3VzZXJ9OntwYXNzd29yZH1Ae2hvc3R9Ontwb3J0fS97ZGJ9Ii5mb3JtYXQodXNlciA9IHVzZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkID0gcGFzc3dvcmQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSBob3N0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3J0ID0gcG9ydCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGIgPSBkYikpDQogICAgICAgIGRvcmlzX3N0cmVhbV9sb2FkX2Zyb21fZGYoZGRkLCBlbmdpbmUsICJyZXN1bHRzIikNCg0KICAgICAgICAjICMg5pyA57uI5oiQ5Yqf55qE6K+d77yM5bCx5Lya6L6T5Ye65LiL6Z2i6L+Z5p2hDQogICAgICAgIHByaW50KCLov5DooYzmiJDlip8iKQ0KICAgICAgICBkZl9rYWZrYSA9IHBkLkRhdGFGcmFtZSh7ImNvZGUiOiAwLCAibXNnIjogIui/kOihjOaIkOWKnyIsICJyZXF1ZXN0SWQiOiByZXF1ZXN0X2lkfSwgaW5kZXg9WzBdKQ0KICAgICAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQoNCmV4Y2VwdCBWYWx1ZUVycm9yIGFzIHZlOg0KICAgIHBhc3MNCg0KZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgIGRmX2thZmthID0gcGQuRGF0YUZyYW1lKHsiY29kZSI6IDEsICJtc2ciOiBmIuS4u+eoi+W6j+WPkeeUn+W8guW4uDoge3N0cihlKX0iLCAicmVxdWVzdElkIjogcmVxdWVzdF9pZH0sIGluZGV4PVswXSkNCiAgICBkZjEgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGZfa2Fma2EpDQoNCiMgcHJpbnQoIuacgOe7iOeahGRmMeaYr++8miIpDQojIHByaW50KHR5cGUoZGYxKSkNCiMgZGYxLnNob3coKQ0KDQojIHByaW50KCLmnIDnu4jnmoTnrpfms5Xnu5PmnpzmmK/vvJoiKQ0KIyBwcmludCh0eXBlKGZpbmFsX3Jlc19hZGRfY29sdW1ucykpDQojIGZpbmFsX3Jlc19hZGRfY29sdW1ucy5zaG93KCkNCg0KDQoNCg0K\",\"paramType\":\"string\"},{\"paramName\":\"params\",\"paramIndex\":3,\"paramValue\":\"{}\",\"paramType\":\"string\"},{\"paramName\":\"model_path_dir\",\"paramIndex\":4,\"paramValue\":\"hdfs://namespace01/data/${tenantId}/${appId}/model\",\"paramType\":\"string\"}],\"input\":[{\"label\":\"input_D1\",\"value\":\"input_D1\",\"type\":\"data\",\"key\":\"1fcbff27-9b37-454e-9cd7-9747b089d700\",\"index\":1}],\"output\":[{\"label\":\"output_D1\",\"value\":\"output_D1\",\"type\":\"data\",\"key\":\"6b91b054-1e6d-4302-a829-3aa538cdb9e9\",\"index\":1}],\"cache\":1,\"autoMatch\":1,\"portsParams\":{\"in\":[{\"key\":\"1fcbff27-9b37-454e-9cd7-9747b089d700\",\"value\":\"input_D1\",\"type\":\"data\"}],\"out\":[{\"key\":\"6b91b054-1e6d-4302-a829-3aa538cdb9e9\",\"value\":\"output_D1\",\"type\":\"data\"}]},\"status\":4,\"setting\":true,\"input_D1\":\"INPUT_D1\",\"output_D1\":\"OUTPUT_D1\"},\"ports\":{\"groups\":{\"left\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}},\"right\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}}},\"items\":[{\"id\":\"1fcbff27-9b37-454e-9cd7-9747b089d700\",\"group\":\"left\",\"attrs\":{\"circle\":{\"r\":10},\"text\":{\"text\":\"D\",\"x\":19,\"y\":6,\"fontSize\":10}}},{\"id\":\"6b91b054-1e6d-4302-a829-3aa538cdb9e9\",\"group\":\"right\",\"attrs\":{\"circle\":{\"r\":10},\"text\":{\"text\":\"D\",\"x\":19,\"y\":6,\"fontSize\":10}}}]}},{\"position\":{\"x\":-375,\"y\":-60},\"shape\":\"custom\",\"id\":\"a464306d-bf43-4c8b-8bfa-e3e6ebdc4b23\",\"icon\":\"kafka输入\",\"zIndex\":3,\"data\":{\"nodeTypeCh\":\"kafka输入\",\"nodeTypeId\":25,\"nodeTypeName\":\"kafka_input\",\"name\":\"kafka输入\",\"description\":\"\",\"config\":[{\"paramName\":\"kafka_host\",\"paramIndex\":1,\"paramValue\":\"10.52.199.81:9092\",\"paramType\":\"string\"},{\"paramName\":\"kafka_topic\",\"paramIndex\":2,\"paramValue\":\"mva_query_topic\",\"paramType\":\"string\"},{\"paramName\":\"kafka_group\",\"paramIndex\":3,\"paramValue\":\"asdc\",\"paramType\":\"string\"},{\"paramName\":\"read_type\",\"paramIndex\":4,\"paramValue\":2,\"paramType\":\"int\"},{\"paramName\":\"partion_number\",\"paramIndex\":5,\"paramValue\":\"\",\"paramType\":\"int\"},{\"paramName\":\"partion_offset\",\"paramIndex\":6,\"paramValue\":\"\",\"paramType\":\"int\"},{\"paramName\":\"timestamp_offset\",\"paramIndex\":7,\"paramValue\":\"\",\"paramType\":\"string\"},{\"paramName\":\"kafka_poll_type\",\"paramIndex\":8,\"paramValue\":\"1\",\"paramType\":\"int\"},{\"paramName\":\"kafka_connect_timeout\",\"paramIndex\":9,\"paramValue\":100000,\"paramType\":\"string\"},{\"paramName\":\"column_types\",\"paramIndex\":10,\"paramValue\":\"[{\\\"columnName\\\":\\\"requestId\\\",\\\"pattern\\\":\\\"\\\",\\\"type\\\":\\\"string\\\",\\\"_X_ROW_KEY\\\":\\\"row_42\\\"},{\\\"columnName\\\":\\\"requestParam\\\",\\\"pattern\\\":\\\"\\\",\\\"type\\\":\\\"string\\\",\\\"_X_ROW_KEY\\\":\\\"row_43\\\"}]\",\"paramType\":\"string\"},{\"paramName\":\"data_mode\",\"paramIndex\":11,\"paramValue\":\"2\",\"paramType\":\"int\"}],\"input\":[],\"output\":[{\"label\":\"output\",\"value\":\"output\",\"type\":\"data\"}],\"cache\":1,\"status\":4,\"setting\":true},\"ports\":{\"groups\":{\"left\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}},\"right\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}}},\"items\":[{\"id\":\"ports-data-1\",\"group\":\"right\",\"attrs\":{\"circle\":{\"r\":10},\"text\":{\"text\":\"D\",\"x\":19,\"y\":6,\"fontSize\":10}}}]}},{\"position\":{\"x\":60,\"y\":-60},\"shape\":\"custom\",\"id\":\"7479efe4-fa74-4f2e-8cef-87eab92f2823\",\"icon\":\"kafka输出\",\"zIndex\":4,\"data\":{\"nodeTypeCh\":\"kafka输出\",\"nodeTypeId\":26,\"nodeTypeName\":\"kafka_out\",\"name\":\"kafka输出\",\"description\":\"\",\"config\":[{\"paramName\":\"kafka_host\",\"paramIndex\":1,\"paramValue\":\"10.52.199.81:9092\",\"paramType\":\"string\"},{\"paramName\":\"kafka_topic\",\"paramIndex\":2,\"paramValue\":\"mva_flow_topic\",\"paramType\":\"string\"},{\"paramName\":\"column_types\",\"paramIndex\":3,\"paramValue\":\"[{\\\"type\\\":\\\"bigint\\\",\\\"columnName\\\":\\\"code\\\",\\\"_X_ROW_KEY\\\":\\\"row_88\\\"},{\\\"type\\\":\\\"string\\\",\\\"columnName\\\":\\\"msg\\\",\\\"_X_ROW_KEY\\\":\\\"row_89\\\"},{\\\"type\\\":\\\"string\\\",\\\"columnName\\\":\\\"requestId\\\",\\\"_X_ROW_KEY\\\":\\\"row_90\\\"}]\",\"paramType\":\"string\"}],\"input\":[{\"label\":\"input\",\"value\":\"input\",\"type\":\"data\"}],\"output\":[],\"cache\":0,\"status\":4,\"setting\":true},\"ports\":{\"groups\":{\"left\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}},\"right\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":10,\"magnet\":true,\"strokeWidth\":2,\"stroke\":\"#ffffff\",\"fill\":\"#707693\",\"filter\":{\"name\":\"dropShadow\",\"args\":{\"dx\":0,\"dy\":0,\"opacity\":0.5,\"color\":\"#bec0d5\"}}},\"text\":{\"text\":\"\",\"fill\":\"#FFFFFF\",\"fontSize\":10,\"pointer-events\":\"none\"}}}},\"items\":[{\"id\":\"ports-data-1\",\"group\":\"left\",\"attrs\":{\"circle\":{\"r\":10},\"text\":{\"text\":\"D\",\"x\":19,\"y\":6,\"fontSize\":10}}}]}}],\"edges\":[{\"shape\":\"edge\",\"id\":\"e91577b0-d43d-494b-bed9-0dd43ba4f4c6\",\"zIndex\":-1,\"source\":{\"cell\":\"a464306d-bf43-4c8b-8bfa-e3e6ebdc4b23\",\"port\":\"ports-data-1\"},\"target\":{\"cell\":\"7fe5aa03-3875-43bd-b7f6-21adda4b3362\",\"port\":\"1fcbff27-9b37-454e-9cd7-9747b089d700\"},\"data\":{\"source\":\"output\",\"target\":\"input_D1\",\"autoMatch\":1}},{\"shape\":\"edge\",\"id\":\"abd6e28f-966a-42a7-832d-1d90f3b2520f\",\"zIndex\":-1,\"source\":{\"cell\":\"7fe5aa03-3875-43bd-b7f6-21adda4b3362\",\"port\":\"6b91b054-1e6d-4302-a829-3aa538cdb9e9\"},\"target\":{\"cell\":\"7479efe4-fa74-4f2e-8cef-87eab92f2823\",\"port\":\"ports-data-1\"},\"data\":{\"source\":\"output_D1\",\"target\":\"input\"}}]}"}